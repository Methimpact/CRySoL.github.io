
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Sincronización remota en 4 pasos con rsync</title>
    
    <meta name="author" content="CRySoL">

    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js" type="text/javascript"></script>
    <script src="/javascripts/main.js"></script>

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="/assets/themes/twitter/bootstrap/css/bootstrap.2.2.2.min.css" rel="stylesheet">
    <link href="/assets/themes/twitter/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">
    <link href="/stylesheets/pygment_trac.css" rel="stylesheet" type="text/css" media="all">

    <!-- Le fav and touch icons -->
  <!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  -->

    <!-- atom & rss feed -->
    <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">

    

  </head>

  <body>
    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-narrow">
<!--
	  <a class="brand-image" href="/"><img class="brand-image" src="/assets/themes/twitter/logo.png"/></a>
-->
          <a class="brand" href="/">CRySoL</a>
          <ul class="nav">
            
            
            


  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      
    
  
    
      
      	
      	<li><a href="/recipes.html">Recipes</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/about.html">About</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
  
    
      
    
  
    
      
      	
      	<li><a href="/archive.html">Archive</a></li>
      	
      
    
  
    
  
    
      
    
  
    
      
      	
      	<li><a href="/users.html">Users</a></li>
      	
      
    
  
    
      
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  



          </ul>
        </div>
      </div>
    </div>

    <div class="container-narrow">

      <div class="row-fluid">
	<div class="content">
          
<div class="sidebar span3">
  <div id="logo">
  <a href="/">
    <img src="/assets/images/logo.png" alt="logo"/>
  </a>
</div>

  <div class="metadata">
  <h2>this</h2>
  <ul>
    
      <li>author: 
  <a href="/users.html#david_garcia">
   david.garcia
  </a>


        
        <span class="author-photo">

  
    <img src="https://securecdn.disqus.com/1372120184/images/noavatar48.png" width="48" alt="no-picture"/>
  

</span>

      </li>
      
      
    

    <li>created: 2009-12-11 </li>

    <li><a href="https://github.com/CRySoL/web.source/raw/master/_posts/migrated/2009-12-11-sincronizacin-remota-en-4-pasos-con-rsync.html">source / <a href="https://github.com/CRySoL/web.source/edit/master/_posts/migrated/2009-12-11-sincronizacin-remota-en-4-pasos-con-rsync.html">edit</a></li>

  
    <li>categories:
    
      <a href="/categories.html#recipe-ref">recipe</a>
    
    </li>
  

  
      <li>migrated&nbsp;from&nbsp;<a href="http://crysol.org/node/1274">node/1274</a></li>
  

  
    <li>tags:
    
      <a href="/tags.html#networking-ref">networking</a>
    
    </li>
  
  </ul>

  
     
     
  

  
     
     
     <a class="tag-icon" href="/tags.html#networking-ref">
        <img src="http://crysol.org/files/category_pictures/networking.png" title="networking" alt="networking-icon"/>
     </a>
     
  

  <!-- AddThis Button BEGIN -->
<div class="share addthis_toolbox addthis_default_style addthis_16x16_style">
<a class="addthis_button_google_plusone_share"></a>
<a class="addthis_button_twitter"></a>
<a class="addthis_button_facebook"></a>
<a class="addthis_button_compact"></a><a class="addthis_counter addthis_bubble_style"></a>
</div>
<script type="text/javascript">var addthis_config = {"data_track_addressbar":true};</script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-51cdd0d57c014017"></script>
<!-- AddThis Button END -->

</div>

<div class="related">
  <h2>related</h2>

  <ul>
   
   
      
        
          
          <li><a href="/enquiry/2011-12-07/filtro-de-contenidos">Filtro de contenidos</a></li>
        
      
        
          
          <li><a href="/recipe/2011-07-05/cmo-usar-tor-en-debian">Cómo usar TOR en Debian</a></li>
        
      
        
          
          <li><a href="/recipe/2011-04-05/the-poors-man-dropbox-thing">The poor's man "dropbox"-thing</a></li>
        
      
        
          
          <li><a href="/new/2011-02-04/se-acab-el-ipv4">Se acabó el IPv4</a></li>
        
      
        
          
          <li><a href="/new/2010-11-07/page-speed">Page Speed</a></li>
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
   
  </ul>

  
</div>

<div class="recent">
  <h2>recent</h2>
  <ul>
  
    <li><a href="/recipe/2013-12-04/authentication-in-IceGrid">Autenticación básica en IceGrid</a></li>
  
    <li><a href="/recipe/2013-11-29/fix-damaged-var-lib-dpkg-available">Fixing damaged /var/lib/dpkg/available</a></li>
  
    <li><a href="/recipe/2013-11-15/reading-a-property-file-with-augeas">Reading a properties file with augeas</a></li>
  
    <li><a href="/recipe/2013-10-28/file-grain-sudo">Fine-grain sudo</a></li>
  
    <li><a href="/recipe/2013-10-21/git-remove-from-history">git: removing files from history</a></li>
  
  </ul>
</div>

</div>

<div class="node span9">
  <div class="page-header">
    <h1>Sincronización remota en 4 pasos con rsync </h1>
  </div>

  <div class="row-fluid post-full">
    <div class="span12">
      <div class="content">
	<blockquote class="head"> 
A día de hoy es común que una persona tenga a su disposición dos ordenadores: un portátil y un sobremesa en casa. Con esta receta veremos cómo sincronizar el sobremesa de casa con nuestro portátil para o bien traer ficheros que estén en el sobremesa a nuestro portátil o bien hacer copias de seguridad del portátil al sobremesa, estemos donde estemos.
</blockquote>

<!--break-->



<h2>Necesitamos...</h2>
<ul>
  <li> Obviamente: conexión a Internet en ambos ordenadores</li>
  <li> Open SSH server  (en el sobremesa)</li>
  <li> rsync (en ambos ordenadores)</li>
</ul>

<h2>Primer paso: Servidor ssh en casa</h2>
Aquí trabajaremos exclusivamente con el ordenador de sobremesa.
Lo primero es lo primero, instalar el paquete <a href="http://www.openssh.com">openssh-server</a> con


<div class="console">
<div class="highlight"><pre><code class="console"><span class="gp">#</span> apt-get install openssh-server
</code></pre></div>
</div>

Con esto nuestro sobremesa ya tiene soporte para recibir órdenes remotas mediante ssh.

<h2>Segundo paso: Configurando el router</h2>
Seguimos en casa con nuestro sobremesa:
Como posiblemente (seguro) la conexión a Internet se hace mediante un router ADSL de la compañía X, hay que configurar el router para que dirija la conexión entrante por el puerto ssh (puerto 22) al ordenador, esto se hace siguiendo los siguientes pasos:

<ol>
<li>Mirar la IP local del router, se puede hacer fácilmente con


<div class="console">
<div class="highlight"><pre><code class="console"><span class="gp">#</span> route | grep default
<span class="go">default         xxx.xxx.xxx.xxx    ...</span>
</code></pre></div>
</div>

La dirección IP local del router es xxx.xxx.xxx.xxx (lo más seguro es que sea del tipo 192.168.x.1)</li>
<li>Mira la IP local del ordenador, si estás conectado con cable:


<div class="console">
<div class="highlight"><pre><code class="console"><span class="gp">$</span> /sbin/ifconfig eth0
</code></pre></div>
</div>

y si estás conectado por inalámbrica:


<div class="console">
<div class="highlight"><pre><code class="console"><span class="gp">$</span> /sbin/ifconfig wlan0
</code></pre></div>
</div>

En la salida que te dé el comando busca en la segunda línea "Direc. inet" o "inet addr.". El número a su lado es la IP local de tu ordenador, que seguramente será del tipo 192.168.x.y
<li>Abre el navegador web</li>
<li>Escribe en la barra de direcciones la IP local del router. Te saldrá un cuadro que te pedirá login para el router. Si no tocaste nada cuando te instalaron el router, el usuario y la contraseña serán "admin". Si cambiaste la configuración usa la que pusiste, y si no la cambiaste te insto a hacerlo, por seguridad.
<li>Dentro del router, pinchamos en un menú llamado "Advanced Setup" o similar, y en dicho menú vamos a la configuración "NAT"</li>
<li>Una vez dentro, tenemos que crear (o añadir) un servidor virtual ("Virtual Servers"). Saldrá una tabla con los puertos que actualmente están abiertos, para qué servicio y hacia qué ordenador (mediante su IP) está dirigido. Encima o debajo de esa tabla habrá un botoncito de "add" y otro de "remove", pincha en "add".</li>
<li>En "Server name", en la opción "select a server" expande el menú y selecciona "Secure Shell Server (SSH)" y debajo en "Server IP" pones la IP de tu ordenador.</li>
<li>Automáticamente debería salir en una tabla debajo que los puertos para este servidor ("external port start/end" e "internal port start/end") son todos el 22 y el protocolo TCP. Abajo del todo, al terminar la tabla, hay un botón de "Save/Apply", pincha en él. Posiblemente te saldrá una ventanita diciendo que como el puerto 22 puede estar en uso, lo redirige al 2222 o alguno por ahí, dale a OK, no hay ningún problema, el software NAT sabe lo que hace para redirigir puertos (port forwarding)</li>
</ol>
<b>IMPORTANTE</b>: Si puedes configurar el servidor DHCP de tu router, haz que siempre asigne la misma IP a tu sobremesa. Si no puedes tiene arreglo: siempre que enciendas tu ordenador comprueba si la IP ha cambiado. Si cambió, debes repetir los pasos de configuración de NAT borrando el servidor virtual anterior y creando uno nuevo para la nueva IP de tu sobremesa.

<h2>Tercer paso: DNS para conectarse remotamente</h2>
Para este paso necesitamos trabajar en un ordenador conectado a la red local de casa, da igual si es nuestro sobremesa o nuestro portátil.
Este paso es significativamente más corto que el anterior en cuanto a explicación.
Dado que lo que queremos es acceder a nuestro ordenador de sobremesa cuando no estamos en casa, tener un DNS propio evita tener que memorizar la IP pública de tu router cada vez que lo enciendas (salvo que hayas contratado IP estática, cada vez que reinicies el router el servicio de conexión le dará una IP pública nueva).
Para obtener un nombre de dominio propio y gratuito podemos acudir a una página como <a href="http://www.dyndns.com">DynDNS</a>, donde podemos crear una cuenta gratuita y registrar la IP pública actual del router con un nombre de dominio gratuito. Para hacer esto, una vez que tienes la cuenta y has entrado en ella, debes seguir los siguientes pasos:
<ol>
<li>Ir a "My services"</li>
<li>Buscar "Host services" y pinchar en "Add hostname"</li>
<li>Rellenar la cajita con un nombre de dominio válido (todo minúsculas, sin caracteres especiales...), por ejemplo "sobremesa-fulanito"</li>
<li>En el menú de selección del "." elige uno gratuito, como por ejemplo "ath.cx", de forma que el nombre es "sobremesa-fulanito.ath.cx"</li>
<li>En "Service type" marca la opción "Host with IP address"</li>
<li>En "IP address" aparecerá un recuadro en blanco y debajo un texto en azul que dice "Use autodetected IP address xxx.xxx.xxx.xxx" (Usar dirección IP auto-detectada xxx.xxx.xxx.xxx), pincha ahí, la dirección xxx.xxx.xxx.xxx es la IP pública actual de tu router.</li>
<li>No marques la casilla de "Mail routing" y dale a "Add to cart", sigue los pasos de "compra" (que sale por la cifra de 0.00$) y listos, tenemos nombre de dominio</li>
</ol>

<b>IMPORTANTE</b>: Cuando apagues y vuelvas a encender el router, entra de nuevo en tu cuenta, y en "Host services" pincha sobre tu nombre de dominio, mira si la IP de la cajita ha cambiado con respecto a la autodetectada y si es así, cámbiala y guarda los cambios.

<b>NOTA</b>: Este nombre de dominio sólo es útil para cuando estás fuera de tu red local de casa, ya que cuando estás "de puertas para dentro", no habría sido necesario configurar nada en el router, de hecho, si estás en tu casa, esto no tiene mucho sentido ya que es más lento que si coges un dispositivo USB, copias lo que sea y te lo llevas al otro ordenador y lo copias en él. Sin embargo, para pruebas de conectividad y que funciona, mira más abajo cómo hacerlo.

<h2>Cuarto paso: rsync</h2>
Necesitamos tener instalado en ambos ordenadores el programa rsync. Si no estuviese, lo instalamos con


<div class="console">
<div class="highlight"><pre><code class="console"><span class="gp">#</span> apt-get install rsync
</code></pre></div>
</div>

Para más información sobre la gran cantidad de opciones de rsync, usar las páginas del manual del sistema sobre rsync. Nosotros necesitamos básicamente la opción <b>-a</b> para indicar a rsync que vamos a trabajar sobre archivos y si queremos <b>-v</b> para que nos muestre todo lo que va haciendo (modo verboso).

Una vez hecho todo esto, con nuestro sobremesa encendido en casa y todo puesto a punto, si queremos copiar algo del portátil al ordenador debemos escribir


<div class="console">
<div class="highlight"><pre><code class="console"><span class="gp">$</span> rsync -av ruta_origen_en_portátil <span class="o">[</span>usuario@<span class="o">]</span>nombre-domino-sobremesa:/ruta_destino_en_sobremesa
</code></pre></div>
</div>

Cuando rsync logre conectar por ssh al sobremesa, te pedirá la contraseña del usuario en el sobremesa (aunque puedes evitar que lo haga, mirando <a href="http://crysol.org/es/node/6">esta otra receta de David Villa</a>) y una vez todo esté bien, rsync hará dos tablas de archivos: una del portátil y otra del sobremesa. Los archivos que no estén en el sobremesa los copiará, y si hay archivos más recientes los sobreescribirá. Hay que tener cuidado al usar esto, ya que podemos sobreescribir algo que no queríamos sobreescribir, añadir algo que no queríamos añadir...o borrar algo que no queríamos borrar, por eso lo mejor es trabajar con directorios vacíos en destino y directorios con sólo lo que nos interesa en el origen.

Si lo que queremos es hacer lo de antes desde el portátil pero que el sobremesa sea el origen, pues lo mismo pero cambiando el orden:


<div class="console">
<div class="highlight"><pre><code class="console"><span class="gp">$</span> rsync -av <span class="o">[</span>usuario@<span class="o">]</span>nombre-domino-sobremesa:/ruta_origen_en_sobremesa ruta_destino_en_portátil
</code></pre></div>
</div>

<b>NOTA IMPORTANTE de SINTAXIS de RSYNC</b>: Cuando una ruta de directorio tiene un espacio en blanco, en la terminal escribimos


<div class="console">
<div class="highlight"><pre><code class="console"><span class="gp">$</span> <span class="nb">cd </span>directorio<span class="se">\ </span>con<span class="se">\ </span>espacios
</code></pre></div>
</div>

Cuando una ruta de ese estilo tenemos que escribirla en rsync, debemos escribir \\\ en lugar de \ para que se pase bien el carácter blanco del espacio.


<div class="console">
<div class="highlight"><pre><code class="console"><span class="gp">$</span> rsync &lt;opciones&gt; &lt;ruta_origen&gt; <span class="o">[</span>usuario@<span class="o">]</span>dominio:/ruta_a/directorio<span class="se">\\\ </span>con<span class="se">\\\ </span>espacios/
</code></pre></div>
</div>

<b>NOTA PARA NO INICIADOS</b>: Para crear un directorio nuevo en el sobremesa desde el portátil usa el comando ssh:


<div class="console">
<div class="highlight"><pre><code class="console"><span class="gp">usuario@portatil$</span> ssh <span class="o">[</span>usuario@<span class="o">]</span>nombre-dominio-sobremesa
</code></pre></div>
</div>

y cuando hayas verificado tu identidad con la contraseña del usuario en el sobremesa, tu terminal cambiará a la del sobremesa y entonces puedes hacer:


<div class="console">
<div class="highlight"><pre><code class="console"><span class="gp">usuario@sobremesa$</span> mkdir ruta_dir_padre/nombre_dir_nuevo
<span class="gp">usuario@sobremesa$</span> <span class="nb">exit</span>
</code></pre></div>
</div>

Y ya está, con esto tenemos sincronización básica entre nuestros ordenadores. Por supuesto hay miles de formas de mejorar esto, y se puede hacer muchas cosas con rsync.

<h2>Probando rsync y ssh desde casa</h2>
Los pasos 2 y 3 de esta receta son para poder acceder al ordenador de sobremesa que está detrás de un router cuando nosotros nos encontramos con el portátil en otra red distinta, pero, si queremos hacer pruebas de rsync y ssh entre el portátil y el sobremesa desde casa, no podemos usar el nombre de dominio, debemos usar directamente las IPs privadas de la red.

Por ejemplo, nuestro sobremesa tiene la IP privada 192.168.1.2, si queremos ejecutar comandos mediante ssh desde el portátil tendremos que hacer


<div class="console">
<div class="highlight"><pre><code class="console"><span class="gp">$</span> ssh <span class="o">[</span>usuario@<span class="o">]</span>192.168.1.2
</code></pre></div>
</div>

Si en vez de la IP hubiésemos escrito el nombre de dominio del paso 3, ssh nos dirá que la conexión fue rechazada, y lo mismo con rsync (puesto que usa ssh)


<div class="console">
<div class="highlight"><pre><code class="console"><span class="gp">$</span> rsync &lt;opciones&gt; &lt;ruta_origen&gt; <span class="o">[</span>usuario@<span class="o">]</span>192.168.1.2:/ruta_destino
</code></pre></div>
</div>

o viceversa, como hemos visto antes.

<h2>Para finalizar</h2>

Aquí en <a href="http://crysol.org">CRySoL</a> hay más recetas sobre sincronización, control de versiones y ssh. Esta es sólo una forma más para sincronizar de forma remota un par de ordenadores. Con otras recetas se puede mejorar mucho lo que he explicado aquí, e insto a los curiosos e interesados en el tema a leerlas (por ejemplo sobre <a href="http://crysol.org/es/search/node/unison">unison</a> y <a href="http://crysol.org/es/search/node/git">git</a>).

<h2>Referencias</h2>
<ul>
<li><a href="http://ubuntulife.wordpress.com/2007/03/15/instalar-un-servidor-ssh/">Instalar servidor ssh</a></li>
<li><a href="http://www.samba.org/ftp/rsync/rsync.html">rsync man pages</a></li>
<li><a href="http://www.openssh.com/">Open SSH</a></li>
<li><a href="ttp://unixhelp.ed.ac.uk/CGI/man-cgi?ssh+1">ssh man pages</a></li>
<li>Experiencias de ensayo-error con rsync proporcionadas por <a href="http://crysol.org/es/user/26">Lk2</a></li>
</ul>

      </div>

      

      <hr/>

      <div class="pagination pagination-centered">
  <ul>
    
      <li class="prev"><a href="/recipe/2009-12-07/compilar-linux-para-la-tarjeta-arm-mini2440" title="Compilar Linux para la tarjeta arm mini2440">&larr; Previous</a></li>
    

    <li><a href="/archive.html">Archive</a></li>

    
      <li class="next"><a href="/recipe/2009-12-13/usar-una-particin-real-con-virtualbox" title="Usar una partición real con Virtualbox">Next &rarr;</a></li>
    
  </ul>
</div>


      <hr/>

      

<div id="show_comments"> [ <a onclick="show_comments();"> show comments </a> ] </div>


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'crysol'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>






    </div>
  </div>
</div>


	</div>
      </div>

      <hr/>

      <footer>
        <p>&copy; 2013 CRySoL
          with help from <a href="http://jekyllbootstrap.com" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll Bootstrap</a>
          and <a href="http://twitter.github.com/bootstrap/" target="_blank">Twitter Bootstrap</a>.
	  See <a href="https://github.com/CRySoL/web.source" target="_blank">site sources</a>.
	  <br/>
	  Generated at Wed Dec 04 20:51:13 +0100 2013
	</p>
      </footer>

    </div>

    
  </body>
</html>

