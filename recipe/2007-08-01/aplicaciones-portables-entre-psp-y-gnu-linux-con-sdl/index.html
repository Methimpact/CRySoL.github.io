
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Aplicaciones portables entre PSP y GNU/Linux con SDL</title>
    
    <meta name="author" content="CRySoL">

    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js" type="text/javascript"></script>
    <script src="/javascripts/main.js"></script>

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="/assets/themes/twitter/bootstrap/css/bootstrap.2.2.2.min.css" rel="stylesheet">
    <link href="/assets/themes/twitter/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">
    <link href="/stylesheets/pygment_trac.css" rel="stylesheet" type="text/css" media="all">

    <!-- Le fav and touch icons -->
  <!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  -->

    <!-- atom & rss feed -->
    <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">

    

  </head>

  <body>
    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-narrow">
<!--
	  <a class="brand-image" href="/"><img class="brand-image" src="/assets/themes/twitter/logo.png"/></a>
-->
          <a class="brand" href="/">CRySoL</a>
          <ul class="nav">
            
            
            


  
    
  
    
      
      	
      	<li><a href="/about.html">About</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/archive.html">Archive</a></li>
      	
      
    
  
    
      
    
  
    
  
    
      
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      
    
  
    
      
      	
      	<li><a href="/recipes.html">Recipes</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/users.html">Users</a></li>
      	
      
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  



          </ul>
        </div>
      </div>
    </div>

    <div class="container-narrow">

      <div class="row-fluid">
	<div class="content">
          
<div class="sidebar span3">
  <div id="logo">
  <a href="/">
    <img src="/assets/images/logo.png" alt="logo"/>
  </a>
</div>

  <div class="metadata">
  <h2>this</h2>
  <ul>
    
      <li>author: 
  <a href="/users.html#int-0">
   int-0
  </a>


        
        <span class="author-photo">

  
    <img src="/assets/files/pictures/picture-8.jpg" width="48" alt="picture"/>
  

</span>

      </li>
      
      
    

    <li>created: 2007-08-01 </li>

    <li><a href="https://github.com/CRySoL/web.source/raw/master/_posts/migrated/2007-08-01-aplicaciones-portables-entre-psp-y-gnu-linux-con-sdl.html">source / <a href="https://github.com/CRySoL/web.source/edit/master/_posts/migrated/2007-08-01-aplicaciones-portables-entre-psp-y-gnu-linux-con-sdl.html">edit</a></li>

  
    <li>categories:
    
      <a href="/categories.html#recipe-ref">recipe</a>
    
    </li>
  

  
      <li>migrated&nbsp;from&nbsp;<a href="http://crysol.org/node/746">node/746</a></li>
  

  
    <li>tags:
    
      <a href="/tags.html#graphics-ref">graphics</a>
    
    </li>
  
  </ul>

  
     
     
  

  
     
     
  

  <!-- AddThis Button BEGIN -->
<div class="share addthis_toolbox addthis_default_style addthis_16x16_style">
<a class="addthis_button_google_plusone_share"></a>
<a class="addthis_button_twitter"></a>
<a class="addthis_button_facebook"></a>
<a class="addthis_button_compact"></a><a class="addthis_counter addthis_bubble_style"></a>
</div>
<script type="text/javascript">var addthis_config = {"data_track_addressbar":true};</script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-51cdd0d57c014017"></script>
<!-- AddThis Button END -->

</div>

<div class="related">
  <h2>related</h2>

  <ul>
   
   
      
        
          
          <li><a href="/tale/2011-07-24/la-historia-de-opengl-vs-direct3d">La Historia de OpenGL vs Direct3D</a></li>
        
      
        
          
          <li><a href="/art/2009-05-27/quin-dijo-que-con-inkscape-no-se-poda">¿Quién dijo que con inkscape no se podía?</a></li>
        
      
        
          
          <li><a href="/script/2009-01-07/gimp-recortar-una-imagen-en-lnea-de-rdenes">Gimp: recortar una imagen en línea de órdenes</a></li>
        
      
        
          
          <li><a href="/recipe/2008-06-07/scanner-hp-scanjet-3200c">Scanner HP Scanjet 3200C</a></li>
        
      
        
          
          <li><a href="/recipe/2008-03-25/programacin-de-shaders-glsl-en-gnu-linux">Programación de Shaders GLSL en GNU/Linux</a></li>
        
      
        
      
        
      
        
      
        
      
        
      
   
  </ul>

  
</div>

<div class="recent">
  <h2>recent</h2>
  <ul>
  
    <li><a href="/recipe/2014-10-08/introduction-to-ogre3d">Introduccion a Ogre3D</a></li>
  
    <li><a href="/recipe/2014-09-28/nautilus-sort-directories-first">nautilus: list folder before files</a></li>
  
    <li><a href="/recipe/2014-05-27/vagrant-multi-machine">multi machine Vagrantfile</a></li>
  
    <li><a href="/recipe/2014-05-20/veewee-on-debian">Installing veewee on Debian sid</a></li>
  
    <li><a href="/recipe/2014-05-19/latex-packages">Useful LaTeX packages and their main commands</a></li>
  
  </ul>
</div>

</div>

<div class="node span9">
  <div class="page-header">
    <h1>Aplicaciones portables entre PSP y GNU/Linux con SDL </h1>
  </div>

  <div class="row-fluid post-full">
    <div class="span12">
      <div class="content">
	<blockquote>Aquí estamos de nuevo para dar un poco de caña a nuestras PSP's, ya sabemos cómo desarrollar aplicaciones multimedia para la consola, ahora vamos a dar dos pasos más: las aplicaciones usarán <em>SDL</em> y serán portables entre nuestro <em>GNU/Linux</em> y nuestra <em>PSP</em>.</blockquote>

<!--break-->



<h2>Introducción</h2>
A todos nos gusta programar de vez en cuando alguna aplicación que use gráficos. Para los que tengáis experiencia probablemente conoceréis <a href="http://www.libsdl.org/">libSDL</a>, se trata de un conjunto de bibliotecas que nos facilitan el acceso dispositivos de entrada como teclados y <em>joysticks</em>; y dispositivos de salida como tarjetas de vídeo y de sonido. Además incluyen utilidades como cargadores de archivos de imagen o de sonido. Son muy fáciles de usar y están portadas a muchas arquitecturas, entre ellas la <em>PSP</em>.

Por otro lado, son muchas las ventajas de programar una aplicación portable. En nuestro caso la ventaja es evidente: podemos probar nuestro programa sin necesidad de pasarlo a la consola.

Para poder seguir correctamente esta receta es indispensable la receta de <a href="http://crysol.org/node/720">"Programación de la PSP: Intros multimedia"</a> y <a href="http://crysol.org/node/216">"Kit de desarrollo completo para PSP"</a>.

<h2>Nuestra aplicación</h2>
Bueno, a parte de <em>libSDL</em>, existen más librerías especializadas para ayudar a la carga y manipulación de imágenes, para el uso del sonido y la mezcladora, incluso para el uso de fuentes <em>true type</em>. Vamos a hacer una aplicación que use todo esto a la vez :P. Por un lado cargaremos un gráfico de fondo, sobre él pondremos otro gráfico al que aplicaremos efectos de escalado. También mostraremos texto que crearemos nosotros y todo esto amenizado con alguna cancioncilla.

<h2>La biblioteca <em>SDL</em></h2>
Bien, el sistema <em>SDL</em> se divide en varios subsistemas, uno de ellos, por ejemplo, es SDL_Video. Antes de empezar a usar <em>SDL</em> debemos iniciar estos sistemas (y finalizarlos después antes de terminar la aplicación), la estructura básica de una aplicación de este tipo será:

<pre>
#include &#60;SDL/SDL.h&#62;

int main(int argc, char *argv[]) {
  /* Inicializamos nuestras variables y tal */
  ...
  /* Inicializamos dos subsistemas */
  SDL_Init(SDL_INIT_VIDEO|SDL_INIT_SOUND);

  /* Bucle principal */
  do {
    /* Hacemos nuestras cosas */
    ...
  } while (!done);

  /* Finalizamos SDL */
  SDL_Quit();
  exit(0);
}</pre>

Para manejar imágenes emplearemos las <em>SDL_Surfaces</em>, éstas nos permiten tratar tanto las imágenes que usemos como las ventanas de visualización de una forma homogénea. En un principio <em>SDL</em> sólo permite crear <em>surfaces</em> a partir de imágenes BMP, pero gracias a la biblioteca <em>SDL_image</em> podemos cargar también archivos JPG y PNG. Como sabéis, los archivos PNG codifican los píxeles en RGBA (canales de color y de transparencia), en <em>SDL</em> se nos creará una capa con información de transparencia, algo muy útil. En cuando a la creación de la ventana de visualización, será una <em>SDL_Surface</em> especial, donde lo que dibujemos se mostrará por pantalla:

<pre>
#include &#60;SDL/SDL.h&#62;
#include &#60;SDL/SDL_image.h&#62;

/* Inicializacion de variables, si, son globales :( */
SDL_Surface *screen = NULL;
SDL_Surface *src_buffer = NULL;
SDL_Surface *background = NULL;

SDL_Rect dest;
...

int main(int argc, char *argv[]) {
  SDL_Init(SDL_INIT_VIDEO|SDL_INIT_SOUND);

  /* Creamos la surface de la pantalla */
  screen = SDL_SetVideoMode(480, 272, 16, SDL_HWSURFACE);
  /* Y el buffer donde dibujaremos antes de volcar a pantalla */
  scr_buffer = IMG_Load("background.png");

  /* Cargamos el fondo */
  background = IMG_Load("background.png");
  do {
    /* Dibujamos el fondo, primero al buffer */
    dest.x = 0;
    dest.y = 0;
    SDL_BlitSurface(background, NULL, scr_buffer, &dest);

    /* Seguimos dibujando tontunas en el buffer */
    ...

    /* Volcamos el buffer a la pantalla y ya tenemos el frame */
    dest.x = 0;
    dest.y = 0;
    SDL_BlitSurface(scr_buffer, NULL, screen, &dest);
    SDL_Flip(screen);
  } while (!done);

  /* Finalizamos SDL */
  SDL_Quit();
  exit(0);
}</pre>

En cuanto al sonido, emplearemos las funciones de la biblioteca <em>SDL_mixer</em>. Con dichas funciones podremos cargar un archivo con alguna canción y reproducirla de forma automática en segundo plano:

<pre>#include &#60;SDL/SDL.h&#62;
#include &#60;SDL/SDL_image.h&#62;
#include &#60;SDL/SDL_mixer.h&#62;

/* Inicializacion de variables, si, son globales :( */
...
Mix_Music *bgm = NULL;
int music_channel;

int main(int argc, char *argv[]) {
  SDL_Init(SDL_INIT_VIDEO|SDL_INIT_SOUND);
  ...
  /* Cargamos el fondo */
  background = IMG_Load("background.png");

  /* Cargamos la musica */
  bgm = Mix_LoadMUS("am-fm.mod");

  /* Antes del bucle principal comenzamos a reproducir */
  music_channel = Mix_PlayMusic(bgm, -1);

  do {
    ...
  } while (!done);

  /* Finalizamos SDL */
  SDL_Quit();
  exit(0);
}</pre>

Ahora vamos a hacer un pequeño efectillo como demostración de la manipulación de <em>surfaces</em>: un zoom periódico a una imagen cualquiera. Para ello usaremos funciones de la biblioteca <em>SDL_gfx</em>; con esta biblioteca podremos hacer escalados y rotaciones a una capa, obteniendo otra capa con la imagen transformada. Las funciones están bastante optimizadas, aunque el escalado de ampliación consume muchos más recursos que el escalado de reducción. Vayamos con el ejemplo:

<pre>#include &#60;SDL/SDL.h&#62;
#include &#60;SDL/SDL_image.h&#62;
#include &#60;SDL/SDL_mixer.h&#62;
#include &#60;SDL/SDL_rotozoom.h&#62; /* SDL_gfx */

/* Inicializacion de variables, si, son globales :( */
...
SDL_Surface *title = NULL;
SDL_Surface *zoomed_title = NULL;

SDL_Rect ztitle_rect;
SDL_Rect title_dest;

double zoom_factor;
int frame;

int main(int argc, char *argv[]) {
  SDL_Init(SDL_INIT_VIDEO|SDL_INIT_SOUND);
  ...
  /* Cargamos la capa */
  title = IMG_Load("crysol_title.png");

  do {
    /* Calculamos el factor de zoom */
    zoom_factor = 0.5 + (cos(frame * 0.05) * 0.5);
    zoomed_title = zoomSurface(title, zoom_factor, zoom_factor, SMOOTHING_OFF);
    ...
    /* Calculamos la posicion de la esquina superior derecha para que */
    /* quede el titulo centrado */
    SDL_GetClipRect(zoomed_title, &ztitle_rect);
    xtitle = 240 - (ztitle_rect.w / 2);
    ytitle = 50 - (ztitle_rect.h / 2);
    title_dest.x = xtitle;
    title_dest.y = ytitle;
    
    /* Dibujamos el titulo en el buffer (que se volcaba a cada frame) */
    SDL_BlitSurface(zoomed_title, NULL, scr_buffer, &title_dest);
    ...
    ++frame;
  } while (!done);

  /* Finalizamos SDL */
  SDL_Quit();
  exit(0);
}</pre>

Por último sólo nos queda poner los créditos. Para ello usamos una fuente TTF y la biblioteca <em>SDL_ttf</em>. Con sus funciones podemos cargar una fuente y crear <em>surfaces</em> con el texto renderizado. Para este ejemplo también aplicaremos escalado a estas <em>surfaces</em> de texto:

<pre>#include &#60;SDL/SDL.h&#62;
#include &#60;SDL/SDL_image.h&#62;
#include &#60;SDL/SDL_mixer.h&#62;
#include &#60;SDL/SDL_rotozoom.h&#62;
#include &#60;SDL/SDL_ttf.h&#62;

/* Inicializacion de variables, si, son globales :( */
...
TTF_Font *font	= NULL;
SDL_Surface *text = NULL;
SDL_Surface *ttext = NULL;

SDL_Color c;

int main(int argc, char *argv[]) {
  SDL_Init(SDL_INIT_VIDEO|SDL_INIT_SOUND);
  ...
  /* Cargamos la fuente */
  font = TTF_OpenFont("arial.ttf", 12);
  TTF_SetFontStyle(font, TTF_STYLE_NORMAL);

  /* Color del texto */
  c.r = 255;
  c.g = 255;
  c.b = 255;

  do {
    ...
    /* Renderizamos la fuente, la segunda en realidad no */
    /* es necesaria, la hacemos para inicializar la surface */
    text = TTF_RenderText_Blended(font, credito[ic], c);
    ttext = TTF_RenderText_Blended(font, credito[ic], c);
    ...
    /* Calculamos el factor de zoom para los creditos */
    zoom_credit = zoom_credit + cz_factor;
    /* cz_factor es una variable que controlara el zoom */
    /* de los creditos  y cuándo cambiar de credito (ic)*/
    ...
    /* Ahora escalamos el texto, calculamos su centro y al buffer */
    ttext = zoomSurface(text, zoom_credit, zoom_credit, SMOOTHING_OFF);
    SDL_GetClipRect(ttext, &dest);
    dest.x = 240 - (dest.w / 2);
    dest.y = 200 - (dest.h / 2);
    SDL_BlitSurface(ttext, NULL, scr_buffer, &dest);
    ...
  } while (!done);

  /* Finalizamos SDL */
  SDL_Quit();
  exit(0);
}</pre>

Bien, estos simples efectos serán los elementos de nuestra mini-demo. Ahora vamos a ver cómo lograr la portabilidad entre <em>GNU/Linux</em> y nuestras <em>PSP's</em>.

<h2>Compilación</h2>
A la hora de crear el ejecutable para la <em>PSP</em> o el <em>PC</em> la principal diferencia estará en la compilación: las herramientas y librerías que se usan en un caso o en el otro. Para diferenciar ambos procesos he decidido crear dos <em>makefiles</em>: uno (por defecto) que creará el ejecutable normal y otro que creará el <em>EBOOT.PBP</em> para la <em>PSP</em>. Vamos primero con el primero, <tt>Makefile</tt>:

<pre>SDL_CONFIG = sdl-config
DEFAULT_CFLAGS = $(shell $(SDL_CONFIG) --cflags)
MORE_CFLAGS = -O2

CFLAGS = $(DEFAULT_CFLAGS) $(MORE_CFLAGS)
CXXFLAGS = $(DEFAULT_CFLAGS) $(MORE_CFLAGS) -fno-exceptions \ 
     -fno-rtti

LDLIBS = -lSDL_gfx -lSDL_image -lSDL_mixer -lSDL_ttf -lvorbisidec \
     -lfreetype -lpng -ljpeg -lz -lm $(shell $(SDL_CONFIG) --libs)

all: main
main: main.c

clean:
        rm -f *~
        rm -f main.o main</pre>

Como véis es muy simple (y un poco chapucero), pero va bien. Ahora vamos con la versión para <em>PSP</em>, archivo <tt>Makefile.psp</tt>:

<pre>TARGET = Sdl_Example
PSPSDK = $(shell psp-config --pspsdk-path)
PSPBIN = $(shell psp-config --psp-prefix)/bin
SDL_CONFIG = $(PSPBIN)/sdl-config
OBJS =  main.o

DEFAULT_CFLAGS = $(shell $(SDL_CONFIG) --cflags)

MORE_CFLAGS = -G0 -O2 -DPSP

CFLAGS = $(DEFAULT_CFLAGS) $(MORE_CFLAGS)
CXXFLAGS = $(DEFAULT_CFLAGS) $(MORE_CFLAGS) -fno-exceptions \ 
        -fno-rtti

LIBS = -lSDL_gfx -lSDL_image -lSDL_mixer -lSDL_ttf -lvorbisidec \
        -lfreetype -lpng -ljpeg -lz -lm $(shell $(SDL_CONFIG) --libs)

EXTRA_TARGETS = EBOOT.PBP

include $(PSPSDK)/lib/build.mak</pre>

Este <em>makefile</em> no añade iconos ni gráficos al <em>EBOOT.PBP</em> por lo que saldrá uno muy feo... podéis cambiarlo como está en la otra receta recomendada. Para ejecutar el <em>makefile</em> por defecto:


<div class="console">
<div class="highlight"><pre><code class="language-console" data-lang="console"><span class="gp">$</span> make</code></pre></div>
</div>

O si queréis ejecutar el de <em>PSP</em>:


<div class="console">
<div class="highlight"><pre><code class="language-console" data-lang="console"><span class="gp">$</span> make -f Makefile.psp</code></pre></div>
</div>

De todas formas lo suyo sería contar con un único <em>makefile</em> capaz de generar ambos <em>targets</em>... lo dejo como deberes :-P...

Si véis el archivo <em>Makefile.psp</em> veréis que al compilador le introducimos el siguiente parámetro: <b>-DPSP</b>. ¿Esto para qué sirve? pues fácil... lo veremos a continuación ;-).

<h2>Compilación condicional</h2>
Bien, ahora nos encontramos con un problema: queremos hacer un único programa que podamos compilar para ambas arquitecturas, sin embargo existen algunas diferencias a la hora de manejar ciertos aspectos que nos obligan a escribir código diferente para una u otra arquitectura. ¿Cómo se soluciona esto sin hacer varios programas distintos para las distintas arquitecturas?, pues con la <em>compilación condicional</em>. En la compilación condicional podemos tener un área de código que se compile o no según el resultado de una expresión. De esto no debemos abusar porque puede resultar un código poco legible y enrevesado. Debemos intentar escribir un código <em>portable</em>, es decir, que funcione en ambas arquitecturas (usando al máximo las herramientas que <em>SDL</em> nos ofrece) y sólo usar compilación condicional para aquellas partes que no podamos compartir.
Gracias a <em>SDL</em> podemos inicializar todo el sistema de forma independiente al mismo, el único problema que vamos a tener es la terminación de la demo: en PC podemos emplear <em>SDL</em> pero en la <em>PSP</em> debemos instalar los <em>ExitCallbacks</em> que vimos en la otra receta. Estos <em>Callbacks</em> sólo debemos compilarlos cuando queramos generar el <em>EBOOT.PBP</em>. En el <em>makefile</em> que hicimos para <em>PSP</em> vimos que compilábamos con el siguiente parámetro: <b>-DPSP</b>, esto define el símbolo <b>PSP</b> y es ésto lo que podemos usar como expresión en la compilación condicional:

<pre>#ifdef PSP
/* Esto se compila cuando generamos codigo para PSP */
...
#endif

#ifndef PSP
/* Esto se compila si NO generamos codigo para PSP */
...
#endif</pre>

En el PC, para salir debemos leer de la cola de eventos de <em>SDL</em> y si existe un evento de tipo <em>SDL_QUIT</em> finalizamos. Como esto NO lo tenemos que usar cuando compilamos para <em>PSP</em> lo pondremos en bloques <em>#ifndef PSP</em>:

<pre>/* Inicializacion de variables, si, son globales :( */
...
#ifndef PSP
SDL_Event event;
#endif
...

int main(int argc, char *argv[]){
  ...
  /* Bucle principal */
  do {
    ...
    #ifndef PSP
    while (SDL_PollEvent(&event)) {
      if (event.type == SDL_QUIT) {
        done = 1;
        break;
      }
    }
    #endif
  } while(!done);
  
  SDL_Quit();
  exit(0);
}</pre>

Y ahora la parte de finalización para la <em>PSP</em>:

<pre>#ifdef PSP
#include &#60;pspkernel.h&#62;
#endif
...
int main(int argc, char *argv[]){
  #ifdef PSP
  SetupCallbacks();
  #endif
  ...
  do {
    ...
  } while (!done);
  SDL_Quit();
  #ifdef PSP
  sceKernelExitGame();
  #endif
  exit(0);
}

#ifdef PSP
/* Manejador del callback de salida */
int exit_callback(int arg1, int arg2, void *common)
{
  done = 1;
  return 0;
}

/* Crea el callback de salida */
int CallbackThread(SceSize args, void *argp)
{
  int cbid;
  cbid = sceKernelCreateCallback("Exit Callback", exit_callback, NULL);
  sceKernelRegisterExitCallback(cbid);
  sceKernelSleepThreadCB();
  return 0;
}

/* Crea y configura el hilo para el callback y retorna su ID */
int SetupCallbacks(void)
{
  int thid = 0;
  
  thid = sceKernelCreateThread("update_thread", CallbackThread, 0x11, 0xFA0, 0, 0);
  if(thid >= 0)
    {
      sceKernelStartThread(thid, 0, 0);
    }
  
  return thid;
}
#endif</pre>

Y con esto ya podremos finalizar la aplicación en la <em>PSP</em> de forma normal, de no ser así, la demo nunca finalizaría (bueno... apagando a lo bestia si...).

<h2>Apéndice A: El programa completo</h2>
Este código es bastante feo, tiene variables globales y está muy poco optimizado; pero eso es otra historia ;-):
<pre>/*
  SDL Programming example for PSP

  by Int-0 (CRySoL)

  22 jul 2007
*/

#include &#60;stdio.h&#62;
#include &#60;stdlib.h&#62;
#include &#60;string.h&#62;
#include &#60;SDL/SDL.h&#62;
#include &#60;SDL/SDL_image.h&#62;
#include &#60;SDL/SDL_mixer.h&#62;
#include &#60;SDL/SDL_rotozoom.h&#62;
#include &#60;SDL/SDL_ttf.h&#62;

#ifdef PSP
#include &#60;pspkernel.h&#62;
#endif

#define CREDITS 20

/* Algunos valores */
int done;
int use_sound;
int frame;

#ifndef PSP
SDL_Event event;
#endif

int xtitle;
int ytitle;

double zoom_factor;
double zoom_credit;
double cz_factor;
int c_wait;

/* SDL sourfaces */
SDL_Surface * screen = NULL;
SDL_Surface * scr_buffer = NULL;
SDL_Surface * background = NULL;

SDL_Surface * title = NULL;

SDL_Surface * zoomed_title = NULL;

/* Musica */
Mix_Music * bgm = NULL;
int music_channel;

/* Areas */
SDL_Rect dest;
SDL_Rect ztitle_rect;
SDL_Rect title_dest;

/* Fuentes */
TTF_Font * font	= NULL;
SDL_Surface * text = NULL;
SDL_Surface * ttext = NULL;

/* Timer */
Uint32 lastTock = 0;
unsigned const int speed = 150;

char *credits[CREDITS];
int in_c;

/* Prototypes */
int Init();
void fatalError(char * str, ...);
SDL_Surface * imgLoad(char * fname);

int initSurfaces();
int initSounds();

int loadFonts();
int txt(char * str, int c, int v, int h);

/* Enums */

enum TxtColours{
  RED,
  GREEN,
  BLUE,
  WHITE,
  BLACK
};

int main(int argc, char *argv[]){
  /* Inicializamos SDL y cargamos los gráficos */
  if(!Init())
    fatalError("Initalisation Failed\n\r");

  /* Empecemos con la musiquita... */
  if (use_sound)
    music_channel = Mix_PlayMusic(bgm, -1);

  /* Bucle principal */
  do {
    if(SDL_GetTicks()-lastTock &#62; speed){
      lastTock = 0;
    }

    /* Dibujamos el fondo */
    dest.x = 0;
    dest.y = 0;
    SDL_BlitSurface(background, NULL, scr_buffer, &dest);

    /* Mostramos el titulo */
    zoom_factor = 0.5 + (cos(frame * 0.05) * 0.5);
    zoomed_title = zoomSurface(title, zoom_factor, zoom_factor, SMOOTHING_OFF);

    SDL_GetClipRect(zoomed_title, &ztitle_rect);
    xtitle = 240 - (ztitle_rect.w / 2);
    ytitle = 50 - (ztitle_rect.h / 2);
    title_dest.x = xtitle;
    title_dest.y = ytitle;

    SDL_BlitSurface(zoomed_title, NULL, scr_buffer, &title_dest);

    /* Dibujamos los créditos */
    ttext = zoomSurface(text, zoom_credit, zoom_credit, SMOOTHING_OFF);
    SDL_GetClipRect(ttext, &dest);
    dest.x = 240 - (dest.w / 2);
    dest.y = 200 - (dest.h / 2);
    SDL_BlitSurface(ttext, NULL, scr_buffer, &dest);

    zoom_credit = zoom_credit + cz_factor;
    if ((zoom_credit &#60;= 1.5)&&(cz_factor == -0.1)) {
      cz_factor = 0;
    }

    if (cz_factor == 0) {
      --c_wait;
    }

    if (c_wait &#60;= 0) {
      cz_factor = -0.15;
      c_wait = 100;
    }

    if (zoom_credit &#60;= 0.1) {
      c_wait = 100;
      cz_factor = -0.1;
      zoom_credit = 4;
      
      /* Siguiente credito */
      in_c = (in_c + 1) % CREDITS;
      txt(credits[in_c], WHITE, 5, 5);
    }

    /* Dibujamos el buffer */
    dest.x = 0;
    dest.y = 0;
    SDL_BlitSurface(scr_buffer, NULL, screen, &dest);

    SDL_Flip(screen);
    
    SDL_FreeSurface(zoomed_title);
    SDL_FreeSurface(ttext);

    ++frame;

    /* Estas rutinas no son necesarias en la PSP puesto */
    /* que tenemos configurados los ExitCallbacks */
    #ifndef PSP
    while(SDL_PollEvent(&event)) 
      {
	if (event.type == SDL_QUIT)
	  {
	    done = 1;
	    break;
	  }
      }
    #endif

  } while(!done);
    
  /* Venga, hasta luego */
  SDL_Quit();

  #ifdef PSP
  sceKernelExitGame();
  #endif
  exit(0);
}

int Init(){
  /* Hilos de finalizacion */
  #ifdef PSP
  SetupCallbacks();
  #endif

  /* Inicializaciones globales */
  done = 0;
  use_sound = 1;
  music_channel = 0;

  zoom_credit = 4;
  cz_factor = -0.1;
  c_wait = 100;

  frame = 0;

  lastTock = 0;
  
  /* Inicializacion de SDL */
  if (SDL_Init(SDL_INIT_VIDEO) &#60; 0)
    fatalError("No se pudo inicializar el sistema SDL\n\r");

  /* Cargamos las fuentes TTF */
  if(!loadFonts())
    fatalError("No se pudo cargar la fuente\n\r");

  /* Cargamos las imagenes */
  if(!initSurfaces())
    fatalError("No se pudieron cargar las imagenes\n\r");

  /* Cargamos los sonidos */
  if(!initSounds())
    fatalError("No se pudieron cargar los sonidos\n\r");
  
  /* Borramos la pantalla */
  dest.x = 0;
  dest.y = 0;
  dest.w = 480;
  dest.h = 272;
  SDL_FillRect(screen, &dest, SDL_MapRGB(screen->format, 0, 0, 0));

  dest.x = 0;
  dest.y = 0;
  SDL_BlitSurface(background, NULL, screen, &dest);
	
  credits[0] = "CRySoL SDL Demo";
  credits[1] = "by Int-0";
  credits[2] = "greetingzzz to";
  credits[3] = "all CRySoL users";
  credits[4] = "all Vigilando users";
  credits[5] = "do you want some names?";
  credits[6] = "ok... in no special order";
  credits[7] = "clet-1";
  credits[8] = "n4xer4s";
  credits[9] = "kitty bang!";
  credits[10] = "brue the one";
  credits[11] = "modern girl";
  credits[12] = "per if";
  credits[13] = "oh...";
  credits[14] = "special thanks to... ";
  credits[15] = "Dark_Alex";
  credits[16] = "pspsdk stuff";
  credits[17] = "ArCO stuff";
  credits[18] = "...and..";
  credits[19] = "anybody!! :)";
  in_c = 0;

  txt(credits[in_c], WHITE, 5, 5);
	
  /* Draw init screen */
  SDL_Flip(screen);
	
  return 1;
}

void fatalError(char * str, ...){
  fprintf(stderr, "Error: %s: %s\n", str, SDL_GetError());
  SDL_FreeSurface(zoomed_title);
  SDL_Quit();

  #ifdef PSP
  sceKernelExitGame();
  #endif

  exit(1);
}

/* Carga una imagen */
SDL_Surface * imgLoad(char * fname){
  return IMG_Load(fname);
}

int initSurfaces(){

  /* Creamos el layer de la pantalla, */
  /* en la PSP es toda la pantalla y en PC será una ventana */
  screen = SDL_SetVideoMode(480, 272, 16, SDL_HWSURFACE);
  if (screen == NULL)
    fatalError("SDL_SetVideoMode Error");

  txt("Loading...", WHITE, 225, 132);
  SDL_Flip(screen);

  /* Cargamos el fondo en layer y en buffer */
  background = imgLoad("background.png");
  scr_buffer = imgLoad("background.png");

  if (background == NULL)
    fatalError("Error cargando background.png");

  title = imgLoad("crysol_title.png");
  if (title == NULL)
    fatalError("Error cargando crysol_title.png");

  return 1;
}

int initSounds(){
  if (SDL_Init(SDL_INIT_AUDIO) &#60; 0)
    use_sound = 0;

  if (use_sound)
    if (Mix_OpenAudio(44100, AUDIO_S16, 2, 512) &#60; 0)
      fatalError("Error configurando la mezcladora");

  if (use_sound){
    bgm = Mix_LoadMUS("am-fm.mod");
    if (bgm == NULL)
      fatalError("Error cargando am-fm.mod");
  }
}

int loadFonts(){
  if (TTF_Init() != 0)
    fatalError("Fallo al inicializar libreria TTF\r\n");
  
  if (!(font = TTF_OpenFont("arial.ttf", 12)))
    fatalError("Error al abrir arial.ttf\r\n");
  
  TTF_SetFontStyle(font, TTF_STYLE_NORMAL);
  
  return 1;
}

int txt(char * str, int colour, int v, int h){
  SDL_Rect rect;
  SDL_Color c;

  switch(colour){
  case 0:
    c.r = 255;
    c.g = 0;
    c.b = 0;
    break;
  case 1:
    c.r = 0;
    c.g = 255;
    c.b = 0;
    break;
  case 2:
    c.r = 0;
    c.g = 0;
    c.b = 255;
    break;
  case 3:
    c.r = 255;
    c.g = 255;
    c.b = 255;
    break;
  case 4:
    c.r = 0;
    c.g = 0;
    c.b = 0;
    break;
  }
  if(!(text = TTF_RenderText_Blended(font, str, c)))
    fatalError("Error renderizando fuente\r\n");

  if(!(ttext = TTF_RenderText_Blended(font, str, c)))
    fatalError("Error renderizando fuente\r\n");
		
  rect.x = v;
  rect.y = h;
	
  return 1;
}

#ifdef PSP
/* Manejador del callback de salida */
int exit_callback(int arg1, int arg2, void *common)
{
  done = 1;
  return 0;
}

/* Crea el callback de salida */
int CallbackThread(SceSize args, void *argp)
{
  int cbid;
  cbid = sceKernelCreateCallback("Exit Callback", exit_callback, NULL);
  sceKernelRegisterExitCallback(cbid);
  sceKernelSleepThreadCB();
  return 0;
}

/* Crea y configura el hilo para el callback y retorna su ID */
int SetupCallbacks(void)
{
  int thid = 0;
  
  thid = sceKernelCreateThread("update_thread", CallbackThread, 0x11, 0xFA0, 0, 0);
  if(thid &#62;= 0)
    {
      sceKernelStartThread(thid, 0, 0);
    }
  
  return thid;
}
#endif</pre>

Como véis, toda la inicialización se ha metido en un método, que a su vez llama a varios métodos para incializar <em>surfaces</em>, sonidos y tipo de letra. Además hay un método encargado de mostrar mensajes de error en caso de producirse. Un apunte más: la función para renderizar texto tiene predefinidos 5 colores: rojo, verde, azul, blanco y negro.

<h2>Apéndice B: Compilar en Debian</h2>
Para poder compilar la demo debéis tener instalados los siguientes paquetes:
<ul><li>libsdl-dev</li>
<li>libsdl-image1.2-dev</li>
<li>libsdl-ttf2.0-dev</li>
<li>libsdl-mixer1.2-dev</li>
<li>libsdl-gfx1.2-dev</li>
<li>libvorbisidec-dev</li></ul>

Vale... vagos... :-P


<div class="console">
<div class="highlight"><pre><code class="language-console" data-lang="console"><span class="gp">#</span> apt-get install libsdl-dev libsdl-image1.2-dev libsdl-ttf2.0-dev libsdl-mixer1.2-dev libsdl-gfx1.2-dev libvorbisidec-dev</code></pre></div>
</div>

<h2>Enlaces</h2>
<ul><li>Página oficial de <a href="http://www.libsdl.org/">libSDL</a>.</li>
<li>Recetas en CRySoL:
<ul><li><a href="http://crysol.org/node/720">"Programación de la PSP: Intros multimedia"</a></li>
<li><a href="http://crysol.org/node/216">"Kit de desarrollo completo para PSP"</a></li></ul></li>
<li>Cortesía de vigilando:
<ul><li><a href="	
http://www.vigilando.org/files/sdltest.zip">Código fuente</a></li>
<li><a href="http://www.vigilando.org/files/arte.zip">Arte</a></li></ul>
</li></ul></li></ul>

En este caso no os voy a poner un vídeo de demostración ya que podéis probarlo en PC (aunque va mucho más rápido porque no controlo la velocidad) :-P.

P.D. A los valientes usuarios de <b>PPC</b>: que sepáis que <b>también funciona!</b> (es más portable que los scripts de <em>euroroam</em> y <em>uclmwifi</em>) ;-)

      </div>

      

      <hr/>

      <div class="pagination pagination-centered">
  <ul>
    
      <li class="prev"><a href="/2007-07-26/intro-psp-pseudo-demoscene-a-k-a-respuesta-a-nuestro-int-0" title="Intro PSP (pseudo demoscene) (a.k.a respuesta a nuestro Int-0)">&larr; Previous</a></li>
    

    <li><a href="/archive.html">Archive</a></li>

    
      <li class="next"><a href="/new/2007-08-01/m-surface-no-esto-no-es-de-m" title="M$ Surface? No... esto no es de M$ :)">Next &rarr;</a></li>
    
  </ul>
</div>


      <hr/>

      

<div id="show_comments"> [ <a onclick="show_comments();"> show comments </a> ] </div>


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'crysol'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>






    </div>
  </div>
</div>


	</div>
      </div>

      <hr/>

      <footer>
        <p>&copy; 2014 CRySoL
          with help from <a href="http://jekyllbootstrap.com" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll Bootstrap</a>
          and <a href="http://twitter.github.com/bootstrap/" target="_blank">Twitter Bootstrap</a>.
	  See <a href="https://github.com/CRySoL/web.source" target="_blank">site sources</a>.
	  <br/>
	  Generated at 2014-10-22 12:41:51 +0200
	</p>
      </footer>

    </div>

    
  </body>
</html>

