
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Linux Vserver en 5 minutos</title>
    
    <meta name="author" content="CRySoL">

    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js" type="text/javascript"></script>
    <script src="/javascripts/main.js"></script>

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="/assets/themes/twitter/bootstrap/css/bootstrap.2.2.2.min.css" rel="stylesheet">
    <link href="/assets/themes/twitter/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">
    <link href="/stylesheets/pygment_trac.css" rel="stylesheet" type="text/css" media="all">

    <!-- Le fav and touch icons -->
  <!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  -->

    <!-- atom & rss feed -->
    <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">

    

  </head>

  <body>
    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-narrow">
<!--
	  <a class="brand-image" href="/"><img class="brand-image" src="/assets/themes/twitter/logo.png"/></a>
-->
          <a class="brand" href="/">CRySoL</a>
          <ul class="nav">
            
            
            


  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      
    
  
    
      
      	
      	<li><a href="/recipes.html">Recipes</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/about.html">About</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
  
    
      
    
  
    
      
      	
      	<li><a href="/archive.html">Archive</a></li>
      	
      
    
  
    
  
    
      
    
  
    
      
      	
      	<li><a href="/users.html">Users</a></li>
      	
      
    
  
    
      
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  



          </ul>
        </div>
      </div>
    </div>

    <div class="container-narrow">

      <div class="row-fluid">
	<div class="content">
          
<div class="sidebar span3">
  <div id="logo">
  <a href="/">
    <img src="/assets/images/logo.png" alt="logo"/>
  </a>
</div>

  <div class="metadata">
  <h2>this</h2>
  <ul>
    
      <li>author: 
  <a href="/users.html#paco">
   paco
  </a>


        
        <span class="author-photo">

  
    <img src="https://securecdn.disqus.com/1372120184/images/noavatar48.png" width="48" alt="no-picture"/>
  

</span>

      </li>
      
    

    <li>created: 2006-08-19 </li>

    <li><a href="https://github.com/CRySoL/web.source/raw/master/_posts/migrated/2006-08-19-linux-vserver-en-5-minutos.textile">source / <a href="https://github.com/CRySoL/web.source/edit/master/_posts/migrated/2006-08-19-linux-vserver-en-5-minutos.textile">edit</a></li>

  
    <li>categories:
    
      <a href="/categories.html#recipe-ref">recipe</a>
    
    </li>
  

  
      <li>migrated&nbsp;from&nbsp;<a href="http://crysol.org/node/378">node/378</a></li>
  

  
  </ul>

  
     
     
  

  

  <!-- AddThis Button BEGIN -->
<div class="share addthis_toolbox addthis_default_style addthis_16x16_style">
<a class="addthis_button_google_plusone_share"></a>
<a class="addthis_button_twitter"></a>
<a class="addthis_button_facebook"></a>
<a class="addthis_button_compact"></a><a class="addthis_counter addthis_bubble_style"></a>
</div>
<script type="text/javascript">var addthis_config = {"data_track_addressbar":true};</script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-51cdd0d57c014017"></script>
<!-- AddThis Button END -->

</div>

<div class="related">
  <h2>related</h2>
  <ul>
    
    <li><a href="/recipe/2005-09-13/ssh-y-scp-para-acceder-a-equipos-remotos-sin-escribir-la-clave-public-key-authentication">SSH y SCP para acceder a equipos remotos sin escribir la clave (public key authentication)</a></li>
    
    <li><a href="/2005-09-24/acabo-de-registrarme-en-el-portal">Acabo de registrarme en el Portal</a></li>
    
    <li><a href="/2005-09-26/buenas-a-tods">Buenas a tod@s!</a></li>
    
    <li><a href="/tale/2005-09-26/instalacin-local-de-mambo-joomla-bajo-gnu-linux">Instalación local de Mambo / Joomla bajo GNU/Linux</a></li>
    
    <li><a href="/recipe/2005-09-27/acceso-a-red-cmpus-con-firefox-y-greasemonkey">Acceso a Red C@mpus con Firefox y Greasemonkey</a></li>
    
  </ul>
</div>

<div class="recent">
  <h2>recent</h2>
  <ul>
  
    <li><a href="/recipe/2013-10-05/virtualbox-import-export-clone">VirtualBox: import/export and cloning machines</a></li>
  
    <li><a href="/recipe/2013-09-23/virtualbox-vmdk-to-vdi">Converting .vmdk virtual disk to .vdi format from command line</a></li>
  
    <li><a href="/recipe/2013-09-19/ice35-deb-packages-from-zeroc">Installing the Ice-3.5 packages from ZeroC on Debian</a></li>
  
    <li><a href="/recipe/2013-09-03/DSO">Undertanding the DSO Link Change</a></li>
  
    <li><a href="/recipe/2013-08-11/hp-p1005-debian">HP LaserJet P1005 with Debian and the free driver</a></li>
  
  </ul>
</div>

</div>

<div class="node span9">
  <div class="page-header">
    <h1>Linux Vserver en 5 minutos </h1>
  </div>

  <div class="row-fluid post-full">
    <div class="span12">
      <div class="content">
	<blockquote class="head">
<p class="head">Linux-Vserver es similar a las zonas de Solaris 9 o a las jaulas de FreeBSD.  Permite ejecutar procesos de forma totalmente aislada respecto a los demás, lo que lo convierte en una especie de máquina virtual ultra-rápida.</p>
</blockquote>
<p><!--break--></p>
<p><!-- break --></p>
<h2>Ingredientes</h2>
<p>Todos son paquetes Debian:</p>
<ul>
	<li>linux-image-2.6.17-2-vserver-686</li>
	<li>util-vserver</li>
	<li>vserver-debiantools</li>
</ul>
<h2>Introducción</h2>
<p>En una receta anterior <a href="http://crysol.inf-cr.uclm.es/node/352">hablábamos de Xen 3.0</a> como una buena forma de implementar servidores virtuales en <span class="caps">GNU</span>/Linux sin mucho esfuerzo y con poca sobrecarga.  Pero cuando el número de servidores virtuales sobre una misma máquina empieza a crecer es el momento de mirar otras alternativas complementarias.</p>
<p>Xen ofrece un aislamiento total, permitiendo la ejecución simultánea de varios núcleos.  ¿Pero y si no necesitamos varios núcleos?  ¿Y si tan solo queremos limitar el riesgo ante una posible intrusión?  ¿Y si tan solo queremos delegar permisos de administración sobre unos servicios?</p>
<p>Una alternativa escalable es Vserver.  Se trata de un parche para Linux que permiten crear múltiples contextos de seguridad y manejar todos ellos como si se trataran de máquinas virtuales.  Es bastante diferente a Xen, puesto que sólo se ejecuta un núcleo, sólo se dispone de una pila <span class="caps">TCP</span>/IP, los recursos están disponibles en todas las máquinas virtuales a no ser que explícitamente se revoquen los permisos.</p>
<h2>Instalación</h2>
<p>Nada más fácil, todos los paquetes se instalan sin problemas.  El kernel con soporte de vserver está ya precompilado y en Debian se incluyen scripts  para facilitar el trabajo con nuestra distribución favorita.</p>
<div class="console">
<div class="highlight"><pre><code class="console"><span class="gp">#</span> apt-get install linux-image-2.6.17-2-vserver-686 util-vserver vserver-debiantools
</code></pre></div></div>
<p>El grub o el lilo se actualiza solo y el initrd se genera también automáticamente.  Ya sólo queda arrancar el sistema con el nuevo kernel (linux-image-2.6.17-2-vserver-686).</p>
<h2>Manejando máquinas virtuales</h2>
<p>Para crear un nuevo servidor virtual se puede usar el script <code>newvserver</code> del paquete <em>vserver-debiantools</em>.  Este script usa la utilidad <b>vserver</b> para la instalación inicial y luego realiza algunos ajustes para adaptarla a Debian.  El script se configura con el archivo <code>/etc/vservers/newvserver-vars</code>. Una configuración sencilla tendría algo así:</p>
<pre>
DIST="sid"
MIRROR="http://ftp.uk.debian.org/debian"
</pre>
<p>Osea, utiliza por defecto la distribución <em>sid</em> (unstable) y el mirror de UK. Cámbialo por tus preferencias si quieres.</p>
<p>Crear nuevas máquinas virtuales es tan sencillo como:</p>
<div class="console">
<div class="highlight"><pre><code class="console"><span class="gp">#</span> newvserver --hostname nombreDelVserver --domain dominioDelVserver --ip direccionIp
</code></pre></div></div>
<p>Donde <em>nombreDelVserver</em> es el nombre del nuevo servidor (e.g. atlante), <em>dominioDelVserver</em> es el dominio del nuevo servidor (e.g. dyndns.org) y <em>direccionIp</em> es la dirección IP del nuevo servidor (e.g. 192.168.1.145).  La dirección IP puede ser de un rango privado o público, por supuesto.</p>
<p>Tras un rato tendremos un nuevo directorio en /var/lib/vservers que contiene un filesystem completo.</p>
<p>Se puede arrancar el nuevo servidor con:</p>
<div class="console">
<div class="highlight"><pre><code class="console"><span class="gp">#</span> vserver nombreDelVserver start
</code></pre></div></div>
<p>Y pararlo con:</p>
<div class="console">
<div class="highlight"><pre><code class="console"><span class="gp">#</span> vserver nombreDelVserver stop
</code></pre></div></div>
<p>Podemos entrar en la consola de cualquier servidor con:</p>
<div class="console">
<div class="highlight"><pre><code class="console"><span class="gp">#</span> vserver nombreDelVserver enter
</code></pre></div></div>
<p>Y salir de ella simplemente terminando la shell (Ctrl-D o exit).</p>
<p>Dentro de la consola podemos instalar software con apt, como si se tratara de una máquina aislada.  Las órdenes de gestión de procesos (ps, kill, etc.) solo afectarán a las de esa máquina virtual aunque todos los procesos se están ejecutando en el mismo núcleo.</p>
<p>Para ver qué maquinas están arrancadas y un mínimo de estadísticas:</p>
<div class="console">
<div class="highlight"><pre><code class="console"><span class="gp">$</span> vserver-stat
</code></pre></div></div>
<p>Para copiar una máquina virtual cambiando la dirección IP y el nombre:</p>
<div class="console">
<div class="highlight"><pre><code class="console"><span class="gp">#</span> vserver-copy --stopstart --ip nuevaIp --domain nuevoDominio nombreDelVserverViejo nombreDelVserverNuevo
</code></pre></div></div>
<p>Y para borrar una máquina virtual que ya no interesa:</p>
<div class="console">
<div class="highlight"><pre><code class="console"><span class="gp">#</span> vserver nombreDelVserver delete
</code></pre></div></div>
<p>La utilidad <em>vserver</em> permite hacer una enorme cantidad de operaciones.  Es más o menos equivalente a la utilidad <em>xm</em> en Xen 3.0.</p>
<h2>Detalles de configuración</h2>
<h3>Compartir los recursos de red</h3>
<p>Cada máquina virtual podrá tener una dirección IP distinta, pero todas ellas se asignarán a los mismos interfaces físicos del host.  Si, por ejemplo, queremos ejecutar un sshd en una máquina virtual y también en el host tendremos que modificar ligeramente la configuración del sshd.  Por defecto en /etc/ssh/sshd_config se asume un:</p>
<pre>
ListenAddress 0.0.0.0
</pre>
<p>Esto indica que el servidor de <span class="caps">SSH</span> escucha en todas las direcciones IP del host.  Debemos cambiarlo tanto en el host como en las máquinas virtuales para indicar una sóla dirección IP.</p>
<h3>Mejorar la seguridad</h3>
<p>Seguro que muchos de vosotros habréis oido hablar de los bugs de Linux que permitían escapar de una jaula <em>chroot</em>. Vserver usa una jaula chroot, lo que os puede hacer un poco reticentes a usarlo.  Afortunadamente hay una solución en linux 2.6 usando los atributos extendidos:</p>
<div class="console">
<div class="highlight"><pre><code class="console"><span class="gp">#</span> setattr --barrier /var/lib/vservers
</code></pre></div></div>
<p>Este atributo dificulta aún más el escapar de una jaula chroot en /var/lib/vservers aunque haya errores en el kernel.</p>
<p>Pero lo más importante es limitar las capacidades de las máquinas virtuales al mínimo necesario.  Esto se consigue editando los archivos <code>/etc/vservers/nombreDelVserver/bcapabilities</code> y <code>/etc/vservers/nombreDelVserver/ccapabilities</code>. Se puede impedir desde el montaje de nuevos dispositivos hasta la ejecución de determinadas llamadas del sistema.</p>
<h3>Una sola dirección IP pública</h3>
<p>Si sólo tienes una dirección IP disponible puedes configurar cada vserver en una dirección privada usando un interfaz de red ficticio (dummy) y luego usar iptables para rutar los paquetes hacia fuera como si vinieran de tu única dirección pública. En <a href="http://linux-vserver.org/HowtoPrivateNetworking">esta página</a> tienes cómo.</p>
<h2>Coexistencia con Xen</h2>
<p>El paquete que incluye el parche de Xen (linux-image-2.6.16-2-xen-vserver-686) también incluye el parche de vserver así que ambos mecanismos pueden hacerse convivir.  Se pueden tener algunas máquinas Xen y tantas Vserver como querramos. Incluso puede haber máquinas que se ejecuten indistintamente con Xen o con Vserver.</p>
<h2>Referencias</h2>
<p>Esta receta solo araña ligeramente las posibilidades de Vserver.  Es posible limitar lo que es posible hacer desde una máquina virtual para que ni siquiera root pueda realizar determinadas actividades potencialmente peligrosas, o se puede compartir parte del sistema de archivos entre varias máquinas virtuales.  En estas referencias teneis más documentación.</p>
<ul>
	<li><a href="http://">Sitio oficial de linux-vserver</a><a href="http://www.linux-vserver.org/">www.linux-vserver.org/</a></li>
	<li><a href="http://deb.riseup.net/vserver/">Linux Vservers</a></li>
	<li><a href="http://linux-vserver.org/Step-by-Step+Guide+2.6">Step-by-Step Guide 2.6</a></li>
	<li><a href="http://">Running Vservers on Debian</a><a href="http://www.section6.net/wiki/index.php/Running_Vservers_on_Debian">www.section6.net/wiki/index.php/Running_Vservers_on_Debian</a></li>
	<li><a href="http://">Linux-Vserver on Debian Testing (Etch), the easy way</a><a href="http://www.howtoforge.com/linux_vserver_debian_etch">www.howtoforge.com/linux_vserver_debian_etch</a></li>
	<li><a href="http://">Cómo Gentoo Linux-VServer</a><a href="http://www.gentoo.org/proj/es/vps/vserver-howto.xml">www.gentoo.org/proj/es/vps/vserver-howto.xml</a></li>
</ul>
      </div>

      

      <hr/>

      <div class="pagination pagination-centered">
  <ul>
    
      <li class="prev"><a href="/recipe/2006-08-15/arreglar-subttulos-srt-desincronizados" title="Arreglar subtítulos SRT desincronizados">&larr; Previous</a></li>
    

    <li><a href="/archive.html">Archive</a></li>

    
      <li class="next"><a href="/opinion/2006-08-19/microsoft-somos-todos" title="Microsoft somos todos">Next &rarr;</a></li>
    
  </ul>
</div>


      <hr/>

      

<div id="show_comments"> [ <a onclick="show_comments();"> show comments </a> ] </div>


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'crysol'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>






    </div>
  </div>
</div>


	</div>
      </div>

      <hr/>

      <footer>
        <p>&copy; 2013 CRySoL
          with help from <a href="http://jekyllbootstrap.com" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll Bootstrap</a>
          and <a href="http://twitter.github.com/bootstrap/" target="_blank">Twitter Bootstrap</a>.
	  See <a href="https://github.com/CRySoL/CRySoL.github.io" target="_blank">site sources</a>.
	  <br/>
	  Generated at Thu Oct 10 02:38:04 +0200 2013
	</p>
      </footer>

    </div>

    
  </body>
</html>

