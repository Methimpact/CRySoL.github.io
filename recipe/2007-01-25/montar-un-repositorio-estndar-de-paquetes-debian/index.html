
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Montar un repositorio estándar de paquetes Debian</title>
    
    <meta name="author" content="CRySoL">

    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js" type="text/javascript"></script>
    <script src="/javascripts/main.js"></script>

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="/assets/themes/twitter/bootstrap/css/bootstrap.2.2.2.min.css" rel="stylesheet">
    <link href="/assets/themes/twitter/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">
    <link href="/stylesheets/pygment_trac.css" rel="stylesheet" type="text/css" media="all">

    <!-- Le fav and touch icons -->
  <!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  -->

    <!-- atom & rss feed -->
    <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">

    

  </head>

  <body>
    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-narrow">
<!--
	  <a class="brand-image" href="/"><img class="brand-image" src="/assets/themes/twitter/logo.png"/></a>
-->
          <a class="brand" href="/">CRySoL</a>
          <ul class="nav">
            
            
            


  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      
    
  
    
      
      	
      	<li><a href="/recipes.html">Recipes</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/about.html">About</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
  
    
      
    
  
    
      
      	
      	<li><a href="/archive.html">Archive</a></li>
      	
      
    
  
    
  
    
      
    
  
    
      
      	
      	<li><a href="/users.html">Users</a></li>
      	
      
    
  
    
      
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  



          </ul>
        </div>
      </div>
    </div>

    <div class="container-narrow">

      <div class="row-fluid">
	<div class="content">
          
<div class="sidebar span3">
  <div id="logo">
  <a href="/">
    <img src="/assets/images/logo.png" alt="logo"/>
  </a>
</div>

  <div class="metadata">
  <h2>this</h2>
  <ul>
    
      <li>author: 
  <a href="/users.html#cleto">
   cleto
  </a>


        
        <span class="author-photo">

  <img src="http://www.gravatar.com/avatar/0ffa4586a8c06cdcafd7d39b4f37a30c?s=48" alt="gravatar"/>

</span>

      </li>
      
    

    <li>created: 2007-01-25 </li>

    <li><a href="https://github.com/CRySoL/web.source/raw/master/_posts/migrated/2007-01-25-montar-un-repositorio-estndar-de-paquetes-debian.textile">source / <a href="https://github.com/CRySoL/web.source/edit/master/_posts/migrated/2007-01-25-montar-un-repositorio-estndar-de-paquetes-debian.textile">edit</a></li>

  
    <li>categories:
    
      <a href="/categories.html#recipe-ref">recipe</a>
    
    </li>
  

  
      <li>migrated&nbsp;from&nbsp;<a href="http://crysol.org/node/534">node/534</a></li>
  

  
    <li>tags:
    
      <a href="/tags.html#Debian-ref">Debian</a>
    
    </li>
  
  </ul>

  
     
     
  

  
     
     
     <a class="tag-icon" href="/tags.html#Debian-ref">
        <img src="http://crysol.org/files/category_pictures/debian.png" title="Debian" alt="Debian-icon"/>
     </a>
     
  

  <!-- AddThis Button BEGIN -->
<div class="share addthis_toolbox addthis_default_style addthis_16x16_style">
<a class="addthis_button_google_plusone_share"></a>
<a class="addthis_button_twitter"></a>
<a class="addthis_button_facebook"></a>
<a class="addthis_button_compact"></a><a class="addthis_counter addthis_bubble_style"></a>
</div>
<script type="text/javascript">var addthis_config = {"data_track_addressbar":true};</script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-51cdd0d57c014017"></script>
<!-- AddThis Button END -->

</div>

<div class="related">
  <h2>related</h2>
  <ul>
    
    <li><a href="/recipe/2005-09-13/ssh-y-scp-para-acceder-a-equipos-remotos-sin-escribir-la-clave-public-key-authentication">SSH y SCP para acceder a equipos remotos sin escribir la clave (public key authentication)</a></li>
    
    <li><a href="/2005-09-24/acabo-de-registrarme-en-el-portal">Acabo de registrarme en el Portal</a></li>
    
    <li><a href="/2005-09-26/buenas-a-tods">Buenas a tod@s!</a></li>
    
    <li><a href="/tale/2005-09-26/instalacin-local-de-mambo-joomla-bajo-gnu-linux">Instalación local de Mambo / Joomla bajo GNU/Linux</a></li>
    
    <li><a href="/recipe/2005-09-27/acceso-a-red-cmpus-con-firefox-y-greasemonkey">Acceso a Red C@mpus con Firefox y Greasemonkey</a></li>
    
  </ul>
</div>

<div class="recent">
  <h2>recent</h2>
  <ul>
  
    <li><a href="/recipe/2013-10-12/apt-pinning">Debian apt pinning</a></li>
  
    <li><a href="/recipe/2013-10-10/change-primary-monitor">Changing primary monitor</a></li>
  
    <li><a href="/recipe/2013-10-05/virtualbox-import-export-clone">VirtualBox: import/export and cloning machines</a></li>
  
    <li><a href="/recipe/2013-09-23/virtualbox-vmdk-to-vdi">Converting .vmdk virtual disk to .vdi format from command line</a></li>
  
    <li><a href="/recipe/2013-09-19/ice35-deb-packages-from-zeroc">Installing the Ice-3.5 packages from ZeroC on Debian</a></li>
  
  </ul>
</div>

</div>

<div class="node span9">
  <div class="page-header">
    <h1>Montar un repositorio estándar de paquetes Debian </h1>
  </div>

  <div class="row-fluid post-full">
    <div class="span12">
      <div class="content">
	<p>Ya vimos <a href="http://crysol.inf-cr.uclm.es/node/506">como montar un repositorio trivial de paquetes Debian</a>. Ahora vamos a hacer un repositorio general de paquetes, algo más avanzado y general que lo anterior pero se basa en la misma filosofía.</p>
<p><!--break--></p>
<h1>Estructura de directorios</h1>
<p>Primeramente, debemos crear la estructura de nuestro nuevo repositorio, que vamos a llamar <em>mirepo</em> como ejemplo. El lugar donde lo debemos crear la estructura puede ser cualquiera, por ejemplo en <em>/var/</em>:</p>
<pre>
mirepo
|
+-dists
  |
  |-stable
  | |-main
  | | |-binary-i386
  | | |-binary-powerpc
  | | |-binary-amd64
  | | +-source
  | |-contrib
  | | |-binary-i386
  | | |-binary-powerpc
  | | |-binary-amd64
  | | +-source
  | +-non-free
  |   |-binary-i386
  |   |-binary-powerpc
  |   |-binary-amd64
  |   +-source
  |
  |-testing
  | |-main
  | | |-binary-i386
  | | |-binary-powerpc
  | | |-binary-amd64
  | | +-source
  | |-contrib
  | | |-binary-i386
  | | |-binary-powerpc
  | | |-binary-amd64
  | | +-source
  | +-non-free
  |   |-binary-i386
  |   |-binary-powerpc
  |   |-binary-amd64
  |   +-source
  |
  +-unstable
    |-main
    | |-binary-i386
    | |-binary-powerpc
    | |-binary-amd64
    | +-source
    |-contrib
    | |-binary-i386
    | |-binary-powerpc
    | |-binary-amd64
    | +-source
    +-non-free
      |-binary-i386
      |-binary-powerpc
      |-binary-amd64
      +-source
</pre>
<p>Como se puede ver, vamos a usar las tres distribuciones de Debian (<em>stable</em>, <em>testing</em> y <em>unstable</em>), cada una con sus ramas (<em>main</em>, <em>contrib</em> y <em>non-free</em>), para tres arquitecturas (<em>i386</em>, <em>powerpc</em> y <em>amd64</em>) y con sus respectivos paquetes de fuentes (directorios <em>sources</em>).</p>
<p>Aquí puede sobrar o faltar según tus propias necesidades. Quizás sólo quieras una distribución o incluir también la arquitectura <em>arm</em>; solo tendrías que quitar o añadir las partes que te interesen. Eso sí, <b>siguiendo la estructura específicada</b>.</p>
<h1>Llenando el repositorio</h1>
<p>Los paquetes binarios los debemos almacenar en los directorios binary&#8217;s correspondientes y los sources en la rama que pertenezca. Si tú numero de paquetes es considerable, ni que decir tiene que es aconsejable automatizar esta tarea con algún script que lo haga de forma periódica.</p>
<p>Una vez tengamos todos los archivos en su sitio, si queremos que nuestros usuarios del repositorio puedan utilizar el <a href="http://www.argon.org/~roderick/apt-pinning.html">pinning de <span class="caps">APT</span></a> debemos incluir en cada directorio <em>binary</em> y <em>source</em> un archivo llamado <b>Release</b> con la siguiente forma:<br />
<pre><br />
Archive: &#8220;nombre de la distribución (stable, testing o unstable)&#8221;<br />
Component: &#8220;nombre de la rama (main, contrib, non-free)&#8221;<br />
Origin: &#8220;Persona/compañía/proyecto que da origen al repositorio&#8221;<br />
Label: &#8220;Etiqueta descriptiva&#8221;<br />
Architecture: &#8220;La arquitectura a la que perteneces (i386, powerpc, amd64 o source)&#8221;<br />
</pre></p>
<p>Las comillas serán necesarias dependiendo de si el dato es una cadena sin espacios o no. Es un archivo bastante sencillo y que se debe personalizar para cada directorio binary donde vaya a ser guardado.</p>
<p>Con los repositorios llenos de paquetes y los Release en su sitio sólo nos queda crear los ficheros índices. Utilicemos la herramienta <b>apt</b> para este fin. Antes de nada, tenemos que crear unos ficheros de configuración para que apt haga lo necesario para nuestro repositorio. Vamos a crear, concretamente, 2 tipos de archivos que pueden almacenarse en el raíz del repositorio (<em>/var/mirepo/</em>)</p>
<h2>apt-&#8220;distribucion&#8221;-release.conf</h2>
<p>En nuestro caso, deberíamos crear tres: <em>apt-stable-release.conf, apt-testing-release.conf, apt-unstable-release.conf</em>. Vamos a mostrar la estructura de uno de ellos y la del resto es idéntica, salvo cambios propios de cada distribución. Para la distribución <em>stable</em>, tendríamos en <em>apt-stable-release.conf</em>:<br />
<pre><br />
<span class="caps">APT</span>::FTPArchive::Release::Origin “Tu nombre/empresa/proyecto”;<br />
<span class="caps">APT</span>::FTPArchive::Release::Label “Etiqueta descriptiva”;<br />
<span class="caps">APT</span>::FTPArchive::Release::Suite “stable”;<br />
<span class="caps">APT</span>::FTPArchive::Release::Architectures “i386 powerpc amd64 source”;<br />
<span class="caps">APT</span>::FTPArchive::Release::Components “main contrib non-free”;<br />
<span class="caps">APT</span>::FTPArchive::Release::Description “Descripcion detallada”;<br />
</pre><br />
Debemos rellenar los campos oportunos con los valores específicos para cada uno de los archivos.</p>
<h2>apt-ftparchive.conf</h2>
<p>Este otro archivo de configuración define las reglas que <b>apt</b> usará y aplicará a la hora de crear los ficheros índices. Para nuestro ejemplo sería un archivo bastante largo y no proporciona información añadida hacerlo para todas las ramas, por lo que se muestra sólo la distribución unstable:<br />
<pre><br />
Dir {<br />
  ArchiveDir &#8220;.&#8221;;<br />
  CacheDir &#8220;.&#8221;;<br />
};</p>
<p>#Como se van a comprimir<br />
Default {<br />
  Packages::Compress &#8220;gzip bzip2&#8221;;<br />
  Sources::Compress &#8220;gzip bzip2&#8221;;<br />
  Contents::Compress &#8220;gzip bzip2&#8221;;<br />
};</p>
<p>#Rutas a paquetes binarios<br />
BinDirectory &#8220;dists/unstable/main/binary-i386&#8221; {<br />
  Packages &#8220;dists/unstable/main/binary-i386/Packages&#8221;;<br />
  Contents &#8220;dists/unstable/Contents-i386&#8221;;<br />
  SrcPackages &#8220;dists/unstable/main/source/Sources&#8221;;<br />
};</p>
<p>BinDirectory &#8220;dists/unstable/main/binary-powerpc&#8221; {<br />
  Packages &#8220;dists/unstable/main/binary-powerpc/Packages&#8221;;<br />
  Contents &#8220;dists/unstable/Contents-powerpc&#8221;;<br />
  SrcPackages &#8220;dists/unstable/main/source/Sources&#8221;;<br />
};</p>
<p>BinDirectory &#8220;dists/unstable/main/binary-amd64&#8221; {<br />
  Packages &#8220;dists/unstable/main/binary-amd64/Packages&#8221;;<br />
  Contents &#8220;dists/unstable/Contents-amd64&#8221;;<br />
  SrcPackages &#8220;dists/unstable/main/source/Sources&#8221;;<br />
};</p>
<p>#&lt;&#8212;&#8212;Aquí debemos especificar el resto de rutas a paquetes binarios</p>
<p>#Especifica de qué consta la distribución<br />
Tree &#8220;dists/unstable&#8221; {<br />
  Sections &#8220;main doc&#8221;;<br />
  Architectures &#8220;i386 powerpc amd64&#8221;;<br />
};</p>
<p>#&lt;&#8212;- Las demás distribuciones</p>
<p>Default {<br />
  Packages {<br />
    Extensions &#8220;.deb&#8221;;<br />
  };<br />
</pre></p>
<p>Con esto almacenado y configurado podemos hacernos un breve script (<em>update-archives.sh</em>) que automatizará la actualización del repositorio:<br />
<pre><br />
#!/bin/sh<br />
apt-ftparchive generate apt-ftparchive.conf<br />
apt-ftparchive -c apt-unstable-release.conf release dists/unstable/ &gt;dists/unstable/Release<br />
apt-ftparchive -c apt-stable-release.conf release dists/stable/ &gt;dists/stable/Release<br />
apt-ftparchive -c apt-testing-release.conf release dists/testing/ &gt;dists/testing/Release<br />
</pre><br />
Este script debemos ejecutarlo cada vez que añadamos un paquete binario o fuente a nuestro repositorio. Se puede hacer a mano o utilizando <em>cron</em>.</p>
<h1>Utilizando el repositorio</h1>
<p>Una vez que hemos hecho todo lo anterior podemos añadir la siguiente línea a nuestro <em>/etc/apt/sources.list</em> para utilizar el repositorio de forma local:<br />
<pre>deb file:///var/mirepo unstable main contrib non-free</pre><br />
La línea anterior utilizaría la distribución <em>unstable</em>, con las tres ramas.</p>
<p>Si quieres tenerlo accesible de forma remota, puedes crear un enlace simbólico en <em>/var/www/</em> para redireccionar la consulta <em>http</em> a tu servidor Apache:</p>
<div class="console">
<div class="highlight"><pre><code class="console"><span class="gp">#</span> <span class="nb">cd</span> /var/www
<span class="gp">#</span> ln -s /var/mirepo mirepo
</code></pre></div></div>
<p>Y añadir como repositorio la línea:</p>
<pre>
deb http://midominio.com/mirepo testing main contrib
</pre>
<h1>Referencias</h1>
<ul>
	<li><a href="http://es.tldp.org/Manuales-LuCAS/doc-guia-ubuntu-breeze/guia-ubuntu-htmls/repositorios.html">Traducción  al español del Howto oficial de Debian para crear repositorios.</a></li>
	<li><a href="http://batustack.wordpress.com/tag/gnulinux/debian/">Otro howto bastante completo</a></li>
</ul>
      </div>

      

      <hr/>

      <div class="pagination pagination-centered">
  <ul>
    
      <li class="prev"><a href="/recipe/2007-01-24/lantronix-xport" title="Lantronix XPORT">&larr; Previous</a></li>
    

    <li><a href="/archive.html">Archive</a></li>

    
      <li class="next"><a href="/recipe/2007-01-26/migracin-de-repositorios-subversion" title="Migración de repositorios subversion">Next &rarr;</a></li>
    
  </ul>
</div>


      <hr/>

      

<div id="show_comments"> [ <a onclick="show_comments();"> show comments </a> ] </div>


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'crysol'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>






    </div>
  </div>
</div>


	</div>
      </div>

      <hr/>

      <footer>
        <p>&copy; 2013 CRySoL
          with help from <a href="http://jekyllbootstrap.com" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll Bootstrap</a>
          and <a href="http://twitter.github.com/bootstrap/" target="_blank">Twitter Bootstrap</a>.
	  See <a href="https://github.com/CRySoL/web.source" target="_blank">site sources</a>.
	  <br/>
	  Generated at Sat Oct 12 23:50:23 +0200 2013
	</p>
      </footer>

    </div>

    
  </body>
</html>

