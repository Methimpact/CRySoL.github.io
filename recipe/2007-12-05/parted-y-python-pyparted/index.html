
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Parted y Python: pyparted</title>
    
    <meta name="author" content="CRySoL">

    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js" type="text/javascript"></script>
    <script src="/javascripts/main.js"></script>

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="/assets/themes/twitter/bootstrap/css/bootstrap.2.2.2.min.css" rel="stylesheet">
    <link href="/assets/themes/twitter/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">
    <link href="/stylesheets/pygment_trac.css" rel="stylesheet" type="text/css" media="all">

    <!-- Le fav and touch icons -->
  <!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  -->

    <!-- atom & rss feed -->
    <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">

    

  </head>

  <body>
    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-narrow">
<!--
	  <a class="brand-image" href="/"><img class="brand-image" src="/assets/themes/twitter/logo.png"/></a>
-->
          <a class="brand" href="/">CRySoL</a>
          <ul class="nav">
            
            
            


  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      
    
  
    
      
      	
      	<li><a href="/recipes.html">Recipes</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/about.html">About</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
  
    
      
    
  
    
      
      	
      	<li><a href="/archive.html">Archive</a></li>
      	
      
    
  
    
  
    
      
    
  
    
      
      	
      	<li><a href="/users.html">Users</a></li>
      	
      
    
  
    
      
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  



          </ul>
        </div>
      </div>
    </div>

    <div class="container-narrow">

      <div class="row-fluid">
	<div class="content">
          
<div class="sidebar span3">
  <div id="logo">
  <a href="/">
    <img src="/assets/images/logo.png" alt="logo"/>
  </a>
</div>

  <div class="metadata">
  <h2>this</h2>
  <ul>
    
      <li>author: 
  <a href="/users.html#int-0">
   int-0
  </a>


        
        <span class="author-photo">

  
    <img src="/assets/files/pictures/picture-8.jpg" width="48" alt="picture"/>
  

</span>

      </li>
      
    

    <li>created: 2007-12-05 </li>

    <li><a href="https://github.com/CRySoL/web.source/raw/master/_posts/migrated/2007-12-05-parted-y-python-pyparted.html">source / <a href="https://github.com/CRySoL/web.source/edit/master/_posts/migrated/2007-12-05-parted-y-python-pyparted.html">edit</a></li>

  
    <li>categories:
    
      <a href="/categories.html#recipe-ref">recipe</a>
    
    </li>
  

  
      <li>migrated&nbsp;from&nbsp;<a href="http://crysol.org/node/812">node/812</a></li>
  

  
    <li>tags:
    
      <a href="/tags.html#Python-ref">Python</a>
    
    </li>
  
  </ul>

  
     
     
  

  
     
     
     <a class="tag-icon" href="/tags.html#Python-ref">
        <img src="http://crysol.org/files/category_pictures/python.png" title="Python" alt="Python-icon"/>
     </a>
     
  

  <!-- AddThis Button BEGIN -->
<div class="share addthis_toolbox addthis_default_style addthis_16x16_style">
<a class="addthis_button_google_plusone_share"></a>
<a class="addthis_button_twitter"></a>
<a class="addthis_button_facebook"></a>
<a class="addthis_button_compact"></a><a class="addthis_counter addthis_bubble_style"></a>
</div>
<script type="text/javascript">var addthis_config = {"data_track_addressbar":true};</script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-51cdd0d57c014017"></script>
<!-- AddThis Button END -->

</div>

<div class="related">
  <h2>related</h2>
  <ul>
    
    <li><a href="/recipe/2005-09-13/ssh-y-scp-para-acceder-a-equipos-remotos-sin-escribir-la-clave-public-key-authentication">SSH y SCP para acceder a equipos remotos sin escribir la clave (public key authentication)</a></li>
    
    <li><a href="/2005-09-24/acabo-de-registrarme-en-el-portal">Acabo de registrarme en el Portal</a></li>
    
    <li><a href="/2005-09-26/buenas-a-tods">Buenas a tod@s!</a></li>
    
    <li><a href="/tale/2005-09-26/instalacin-local-de-mambo-joomla-bajo-gnu-linux">Instalación local de Mambo / Joomla bajo GNU/Linux</a></li>
    
    <li><a href="/recipe/2005-09-27/acceso-a-red-cmpus-con-firefox-y-greasemonkey">Acceso a Red C@mpus con Firefox y Greasemonkey</a></li>
    
  </ul>
</div>

<div class="recent">
  <h2>recent</h2>
  <ul>
  
    <li><a href="/recipe/2013-10-12/apt-pinning">Debian apt pinning</a></li>
  
    <li><a href="/recipe/2013-10-10/change-primary-monitor">Changing primary monitor</a></li>
  
    <li><a href="/recipe/2013-10-05/virtualbox-import-export-clone">VirtualBox: import/export and cloning machines</a></li>
  
    <li><a href="/recipe/2013-09-23/virtualbox-vmdk-to-vdi">Converting .vmdk virtual disk to .vdi format from command line</a></li>
  
    <li><a href="/recipe/2013-09-19/ice35-deb-packages-from-zeroc">Installing the Ice-3.5 packages from ZeroC on Debian</a></li>
  
  </ul>
</div>

</div>

<div class="node span9">
  <div class="page-header">
    <h1>Parted y Python: pyparted </h1>
  </div>

  <div class="row-fluid post-full">
    <div class="span12">
      <div class="content">
	<blockquote>Supongo que muchos de vosotros conoceréis <em>libparted</em>, la librería que hay debajo de los programas de particionado típicos de <em>GNU</em>. Muchos de vosotros conocéis también <em>Python</em>, si juntamos estas dos cosas tenemos que hacer programitas que manejen el particionado del disco va a estar al alcance de cualquiera. Llegados a este punto, no sobra decir que: <b>NO me responsabilizo de los daños que pueda causar el uso de esta receta</b>, yo lo he probado con un disco flash y me ha funcionado sin problemas. Quien quiera garantías... que las pague :P.</blockquote>

<!--break-->




<h2>Instalación</h2>
Pues lamentablemente hay que compilar e instalar... no es muy complicado, pero bueno... empecemos por descargarnos los fuentes del modulo de <em>python</em>, los encontramos en <a href="http://dcantrel.fedorapeople.org/pyparted/">http://dcantrel.fedorapeople.org/pyparted/</a>. Hay que tener en cuenta una cosa, a fecha de hoy (4 de diciembre de 2007) en <em>Debian Unstable</em> la versión de <em>libgparted-dev</em> empaquetada es la antiquísima <b>1.7</b>, lo cual nos obliga a usar una versión del módulo antigua: la <b>1.8.5</b>. Esto es un poco rollo, pero por lo menos no tenemos que instalar y configurar <em>libgparted</em> entera. No he probado versiones más nuevas del módulo de <em>python</em>, salvo la versión <em>1.8.9</em> que compilaba pero luego no funcionaba.
Descargados los fuentes nos tenemos que instalar ciertas cosillas:

<div class="console">
<div class="highlight"><pre><code class="console"><span class="gp">#</span> apt-get install libparted-dev uuid-dev
</code></pre></div>
</div>

Si ahora intentáis compilar no os va a funcionar porque el módulo está pensado para el <em>libparted</em> de <em>fedora</em>, que tiene algunos "maquillajes" que, se supone, vienen en los <em>libparted</em> más nuevos (realmente la <em>1.7</em> de <em>Debian</em> es <em>antiquísima</em>), nosotros cambiaremos lo siguiente (abrid como admins el archivo <tt>/usr/include/parted/disk.h</tt>):
<pre>typedef enum {
        PED_PARTITION_NORMAL            = 0x00,
        PED_PARTITION_LOGICAL           = 0x01,
        PED_PARTITION_EXTENDED          = 0x02,
        PED_PARTITION_FREESPACE         = 0x04,
        PED_PARTITION_METADATA          = 0x08
} PedPartitionType;</pre>
Lo cambiaremos por:
<pre>typedef enum {
        PED_PARTITION_NORMAL            = 0x00,
        PED_PARTITION_LOGICAL           = 0x01,
        PED_PARTITION_EXTENDED          = 0x02,
        PED_PARTITION_FREESPACE         = 0x04,
        PED_PARTITION_METADATA          = 0x08,
        PED_PARTITION_PROTECTED         = 0x10
} PedPartitionType;</pre>

...y ahora sí, a compilar:

<div class="console">
<div class="highlight"><pre><code class="console"><span class="go">:~$ unp pyparted-1.8.1.tar.gz</span>
<span class="go">~$ cd pyparted-1.8.1</span>
<span class="go">~/pyparted-1.8.1$ ./configure</span>
<span class="go">~/pyparted-1.8.1$ make &amp;&amp; sudo make install</span>
</code></pre></div>
</div>

<h2>Ejemplos de uso</h2>
Para probar el módulo vamos a usar <em>ipython</em>, si no lo tenéis ya sabéis: <em>apt-get</em> o <em>aptitude</em>. Y una cosa más: hay que ejecutarlo en modo <em>superusuario</em> porque si no no podréis abrir los dispositivos de escritura. En los ejemplos vamos a usar un <em>pendrive</em> direccionado en <tt>/dev/sda</tt>. <b>TENED CUIDADO POR SI VUESTRO DISCO PRINCIPAL ES SATA QUE ENTONCES SERÁ /dev/sda</b>. Si queréis hacer las pruebas con un <em>pendrive</em> comprobad con <em>dmesg</em> el nombre del dispositivo. Y una cosa más: si <em>gnome</em> os automonta la unidad, debéis desmontarla primero.

Al tajo, ejecutamos <em>ipython</em>:


<div class="console">
<div class="highlight"><pre><code class="console"><span class="gp">$</span> sudo ipython
<span class="go">Total number of aliases: 15</span>
<span class="go">Python 2.4.4 (#2, Aug 16 2007, 02:03:40) </span>
<span class="go">Type &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.</span>
<span class="go">IPython 0.8.1 -- An enhanced Interactive Python.</span>
<span class="go">?       -&gt; Introduction to IPython&#39;s features.</span>
<span class="gp">%</span>magic  -&gt; Information about IPython<span class="s1">&#39;s &#39;</span>magic<span class="err">&#39;</span> % functions.
<span class="go">help    -&gt; Python&#39;s own help system.</span>
<span class="go">object? -&gt; Details about &#39;object&#39;. ?object also works, ?? prints more.</span>
<span class="go">In [1]:</span>
</code></pre></div>
</div>

y ahora abrimos la unidad, para ello debemos crear un <em>PedDevice</em> que gestione el dispositivo y con el <em>PedDevice</em> podremos crear un <em>PedDisk</em> que es el objeto que nos permitirá gestionar las particiones, lo haremos todo de una:

<div class="console">
<div class="highlight"><pre><code class="console"><span class="go">In [1]:import parted</span>
<span class="go">In [2]:myDisk = parted.PedDisk.new(parted.PedDevice.get(&#39;/dev/sda&#39;))</span>
</code></pre></div>
</div>

Para acceder al dispositivo (por ejemplo para obligar a realizar un <em>open()</em>, un <em>close()</em> o un <em>sync()</em>) podemos usar el atributo de clase <em>dev</em>:

<div class="console">
<div class="highlight"><pre><code class="console"><span class="go">In [3]:myDisk.dev.open()</span>
</code></pre></div>
</div>

A lo que vamos: leer la información de las particiones. Podemos ver cuántas particiones tenemos y luego recorrer una a una la lista. Hasta lo que creo, no hay un iterador <em>bonico</em> para ello, supongo que en versiones más nuevas ya estará añadido.

<div class="console">
<div class="highlight"><pre><code class="console"><span class="go">In [4]:myDisk.get_last_partition_num()</span>
<span class="go">Out[4]:1</span>
<span class="go">In [5]:partition = myDisk.get_partition(1)</span>
<span class="go">In [6]:partition.type_name</span>
<span class="go">Out[6]:&#39;primary&#39;</span>
<span class="go">In [7]:geometria = partition.geom</span>
<span class="go">In [8]:geom2 = geometria.duplicate()</span>
<span class="go">In [9]:print geometria.start, geometria.end</span>
<span class="go">19 63359</span>
</code></pre></div>
</div>

Ahora vamos a hacer cosas <em>divertidas</em>, <b>OJO QUE ESTO ES PELIGROSO</b>, empezamos borrando TODAS las particiones:

<div class="console">
<div class="highlight"><pre><code class="console"><span class="go">In [10]:myDisk.delete_all()</span>
<span class="go">In [11]:print myDisk.get_partition(1).geom.start</span>
<span class="go">---------------------------------------------------------------------------</span>
<span class="go">parted.error                                     Traceback (most recent call last)</span>
<span class="go">/home/tobias/pyparted-1.7.3/&amp;lt;ipython console&amp;gt;</span>
<span class="go">error: partition not found</span>
</code></pre></div>
</div>

Ahora, para crear una partición, necesitamos: un <em>tipo</em> (primaria, secundaria, etc.), un sector inicial y una longitud. Esta partición va dentro de unos límites, que pueden ser el disco físico o una partición extendida, esos límites los definimos al añadir la partición al disco, pero no al crearla:


<div class="console">
<div class="highlight"><pre><code class="console"><span class="go">In [12]:myPartition=myDisk.partition_new(parted.PARTITION_PRIMARY,None,1,4000)</span>
</code></pre></div>
</div>

El <em>None</em> es el <em>filesystem</em> que llevará la partición, podemos establecerlo en la creación, o a <em>posteriori</em> (como el resto de parámetros):


<div class="console">
<div class="highlight"><pre><code class="console"><span class="go">In [13]:myFs = parted.file_system_type_get(&#39;fat32&#39;)</span>
<span class="go">In [14]:myPartition.set_system(myFs)</span>
</code></pre></div>
</div>

Ahora añadimos la partición al disco, dentro de unos <em>límites</em>, es este caso es todo el disco físico:


<div class="console">
<div class="highlight"><pre><code class="console"><span class="go">In [14]:entireDisk = parted.PedDevice.get(&#39;/dev/sda&#39;).constraint_any()</span>
<span class="go">In [15]:myDisk.add_partition(myPartition, entireDisk)</span>
<span class="go">In [16]:myDisk.commit()</span>
<span class="go">Out[16]:1</span>
</code></pre></div>
</div>

Ese <em>1</em> indica que todo ha ido bien, ahora podemos comprobar con <em>fdisk</em> los destrozos causados :P...

Usando el <em>completion</em> de <em>ipython</em> podemos encontrar muchos métodos interesantes para cálculo de sectores físicos/lógicos, maximización de particiones, etc. De todas formas os puede ser útil la <a href="http://www.gnu.org/software/parted/api/index.html">API de libparted</a>. Para haceros una idea. Por último sólo aclarar que esta receta no va sobre un programa para crear/borrar particiones, para eso tenemos <em>gparted</em>, aquí sólo hemos explicado un poquillo cómo usar los métodos del módulo <em>pyparted</em> por si queréis hacer programillas y tal... ;)

<h2>Enlaces</h2>
Ya están por la receta... :P

      </div>

      

      <hr/>

      <div class="pagination pagination-centered">
  <ul>
    
      <li class="prev"><a href="/2007-12-05/new-debian-developer" title="New Debian Developer">&larr; Previous</a></li>
    

    <li><a href="/archive.html">Archive</a></li>

    
      <li class="next"><a href="/tale/2007-12-07/entrevista-a-ana-mara-mndez-apemit" title="Entrevista a Ana María Méndez (APEMIT)">Next &rarr;</a></li>
    
  </ul>
</div>


      <hr/>

      

<div id="show_comments"> [ <a onclick="show_comments();"> show comments </a> ] </div>


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'crysol'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>






    </div>
  </div>
</div>


	</div>
      </div>

      <hr/>

      <footer>
        <p>&copy; 2013 CRySoL
          with help from <a href="http://jekyllbootstrap.com" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll Bootstrap</a>
          and <a href="http://twitter.github.com/bootstrap/" target="_blank">Twitter Bootstrap</a>.
	  See <a href="https://github.com/CRySoL/CRySoL.github.io" target="_blank">site sources</a>.
	  <br/>
	  Generated at Sat Oct 12 17:17:07 +0200 2013
	</p>
      </footer>

    </div>

    
  </body>
</html>

